<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="SemidÃ¡n Robaina" /><link rel="canonical" href="https://robaina.github.io/Pynteny/references/api/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>API references - Pynteny</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API references";
        var mkdocs_page_input_path = "references/api.md";
        var mkdocs_page_url = "/Pynteny/references/api/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Pynteny
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Subcommands</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../subcommands/search/">Search</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../subcommands/build/">Build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../subcommands/parse/">Parse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../subcommands/download/">Download</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../subcommands/app/">App</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/example_cli/">Example CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/example_api/">Example API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/example_sus/">Sus operon</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">References</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">API references</a>
    <ul class="current">
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Pynteny</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>References &raquo;</li>
      <li>API references</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Robaina/Pynteny/edit/master/docs/references/api.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="api-module">API module</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.api"></a>
  <div class="doc doc-contents first">
  
      <p>Classes to facilitate usage within Python scripts / Notebooks</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.api.Build" class="doc doc-heading">
        <code>Build</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="pynteny.api.Command" href="#pynteny.api.Command">Command</a></code></p>

  
      <p>Build command object.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/api.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Build</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build command object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">outfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Translate nucleotide assembly file and assign contig and gene location </span>
<span class="sd">           info to each identified ORF (using prodigal).</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Path): _description_</span>
<span class="sd">            outfile (Path, optional): _description_. Defaults to None.</span>
<span class="sd">            logfile (Path, optional): _description_. Defaults to None.</span>
<span class="sd">            processes (int, optional): _description_. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">outfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outfile</span><span class="p">,</span>
            <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
            <span class="n">processes</span><span class="o">=</span><span class="n">processes</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getTestDataPath</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get path of test data genbank file (E. coli MG1655)</span>
<span class="sd">        Published in: https://www.ncbi.nlm.nih.gov/nuccore/U00096.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">this_file_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">this_file_dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;tests&quot;</span> <span class="o">/</span> <span class="s2">&quot;test_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;MG1655.gb&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run pynteny search</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">build_database</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Build.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Translate nucleotide assembly file and assign contig and gene location 
   info to each identified ORF (using prodigal).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p><em>description</em></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>outfile</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p><em>description</em>. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>logfile</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p><em>description</em>. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p><em>description</em>. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">outfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Translate nucleotide assembly file and assign contig and gene location </span>
<span class="sd">       info to each identified ORF (using prodigal).</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Path): _description_</span>
<span class="sd">        outfile (Path, optional): _description_. Defaults to None.</span>
<span class="sd">        logfile (Path, optional): _description_. Defaults to None.</span>
<span class="sd">        processes (int, optional): _description_. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="n">outfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outfile</span><span class="p">,</span>
        <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="n">processes</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Build.getTestDataPath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getTestDataPath</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get path of test data genbank file (E. coli MG1655)
Published in: https://www.ncbi.nlm.nih.gov/nuccore/U00096.2</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getTestDataPath</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get path of test data genbank file (E. coli MG1655)</span>
<span class="sd">    Published in: https://www.ncbi.nlm.nih.gov/nuccore/U00096.2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">this_file_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">this_file_dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;tests&quot;</span> <span class="o">/</span> <span class="s2">&quot;test_data&quot;</span> <span class="o">/</span> <span class="s2">&quot;MG1655.gb&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Build.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run pynteny search</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run pynteny search</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">build_database</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.api.Command" class="doc doc-heading">
        <code>Command</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Parent class for Pynteny command</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/api.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Command</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Parent class for Pynteny command</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parent class for Pynteny command</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Executed by Jupyter to print Author and version in html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;table&gt;</span>
<span class="s2">            &lt;tr&gt;</span>
<span class="s2">                &lt;td&gt;&lt;strong&gt;Pynteny version&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;</span><span class="si">{version}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;/tr&gt;&lt;tr&gt;</span>
<span class="s2">                &lt;td&gt;&lt;strong&gt;Author&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;</span><span class="si">{author}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;/tr&gt;</span>
<span class="s2">        &lt;/table&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span>
                   <span class="n">author</span><span class="o">=</span><span class="n">__author__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update argument value in pynteny command.</span>

<span class="sd">        Args:</span>
<span class="sd">            argname (str): argument name to be updated.</span>
<span class="sd">            value (str): new argument value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="n">argname</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cite</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Display Pynteny citation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
            <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="n">__author__</span>
            <span class="p">)</span>
        <span class="n">citation</span> <span class="o">=</span> <span class="n">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Command.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parent class for Pynteny command</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parent class for Pynteny command</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Command.cite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cite</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Display Pynteny citation</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">cite</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Display Pynteny citation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span>
        <span class="n">author</span><span class="o">=</span><span class="n">__author__</span>
        <span class="p">)</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="n">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Command.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">argname</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update argument value in pynteny command.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>argname</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>argument name to be updated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>new argument value.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Update argument value in pynteny command.</span>

<span class="sd">    Args:</span>
<span class="sd">        argname (str): argument name to be updated.</span>
<span class="sd">        value (str): new argument value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">,</span> <span class="n">argname</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.api.Download" class="doc doc-heading">
        <code>Download</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="pynteny.api.Command" href="#pynteny.api.Command">Command</a></code></p>

  
      <p>Download HMM database from NCBI.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/api.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Download</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download HMM database from NCBI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unpack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download HMM database from NCBI.</span>

<span class="sd">        Args:</span>
<span class="sd">            outdir (Path, optional): path to ouput directory in which to store downloaded HMMs.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            logfile (Path, optional): path to log file. Defaults to None.</span>
<span class="sd">            unpack (bool, optional): whether to unpack downloaded file. If False, then PGAP&#39;s database</span>
<span class="sd">                will be unpacked in each Pynteny session. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
            <span class="n">outdir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span> <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outdir</span><span class="p">,</span>
            <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
            <span class="n">unpack</span><span class="o">=</span><span class="n">unpack</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run pynteny download</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">download_hmms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Download.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Download HMM database from NCBI.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>outdir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to ouput directory in which to store downloaded HMMs.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>logfile</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to log file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unpack</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to unpack downloaded file. If False, then PGAP's database
will be unpacked in each Pynteny session. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">outdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unpack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download HMM database from NCBI.</span>

<span class="sd">    Args:</span>
<span class="sd">        outdir (Path, optional): path to ouput directory in which to store downloaded HMMs.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        logfile (Path, optional): path to log file. Defaults to None.</span>
<span class="sd">        unpack (bool, optional): whether to unpack downloaded file. If False, then PGAP&#39;s database</span>
<span class="sd">            will be unpacked in each Pynteny session. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
        <span class="n">outdir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span> <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outdir</span><span class="p">,</span>
        <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
        <span class="n">unpack</span><span class="o">=</span><span class="n">unpack</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Download.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run pynteny download</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run pynteny download</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">download_hmms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.api.Search" class="doc doc-heading">
        <code>Search</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="pynteny.api.Command" href="#pynteny.api.Command">Command</a></code></p>

  
      <p>Search command object.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/api.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Search</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Search command object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">synteny_struc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">gene_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">reuse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">hmm_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">hmmsearch_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Query sequence database for HMM hits arranged in provided synteny structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Path): path to input labelled database.</span>
<span class="sd">            synteny_struc (str): a str describing the desired synteny structure,</span>
<span class="sd">                structured as follows:</span>

<span class="sd">                &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">                where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">                gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">                to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">                More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">                specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">            gene_ids (bool, optional): whether gene symbols are used in synteny </span>
<span class="sd">                string instead of HMM names. Defaults to False.</span>
<span class="sd">            unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">                exact same order displayed in the synteny_structure or in </span>
<span class="sd">                any order If ordered, the filters would filter collinear rather</span>
<span class="sd">                than syntenic structures. Defaults to False.</span>
<span class="sd">            reuse (bool, optional): if True then HMMER3 won&#39;t be run again for HMMs already</span>
<span class="sd">            searched in the same output directory. Defaults to False.</span>
<span class="sd">            hmm_dir (Path, optional): path to directory containing input HMM files.</span>
<span class="sd">                Defaults to None, in which case the PGAP database is downloaded if not</span>
<span class="sd">                already so.</span>
<span class="sd">            hmm_meta (Path, optional): path to PGAP&#39;s metadata file. Defaults to None.</span>
<span class="sd">            outdir (Path, optional): path to output directory. Defaults to None.</span>
<span class="sd">            prefix (str, optional): prefix of output file names. Defaults to &quot;&quot;.</span>
<span class="sd">            hmmsearch_args (str, optional): additional arguments to hmmsearch or hmmscan. Each</span>
<span class="sd">                element in the list is a string with additional arguments for each </span>
<span class="sd">                input hmm (arranged in the same order), an element can also take a </span>
<span class="sd">                value of None to avoid passing additional arguments for a specific </span>
<span class="sd">                input hmm. A single string may also be passed, in which case the </span>
<span class="sd">                same additional argument is passed to hmmsearch for all input hmms.</span>
<span class="sd">                Defaults to None. Defaults to None.</span>
<span class="sd">            logfile (Path, optional): path to log file. Defaults to None.</span>
<span class="sd">            processes (int, optional): maximum number of threads to be employed.</span>
<span class="sd">                Defaults to all minus one.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
            <span class="n">synteny_struc</span><span class="o">=</span><span class="n">synteny_struc</span><span class="p">,</span>
            <span class="n">hmm_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">hmm_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">hmm_dir</span><span class="p">,</span>
            <span class="n">hmm_meta</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span> <span class="k">if</span> <span class="n">hmm_meta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">hmm_meta</span><span class="p">,</span>
            <span class="n">outdir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span> <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outdir</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">hmmsearch_args</span><span class="o">=</span><span class="n">hmmsearch_args</span><span class="p">,</span>
            <span class="n">gene_ids</span><span class="o">=</span><span class="n">gene_ids</span><span class="p">,</span>
            <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
            <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
            <span class="n">unordered</span><span class="o">=</span><span class="n">unordered</span><span class="p">,</span>
            <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">parseGeneIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_struc</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parse gene IDs in synteny structure and find corresponding HMM names</span>
<span class="sd">        in provided HMM database.</span>

<span class="sd">        Args:</span>
<span class="sd">            synteny_struc (str): a str describing the desired synteny structure,</span>
<span class="sd">                structured as follows:</span>

<span class="sd">                &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">                where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">                gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">                to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">                More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">                specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>

<span class="sd">        Returns:</span>
<span class="sd">            str: parsed synteny structure in which gene symbols are replaced by </span>
<span class="sd">                 corresponding HMM names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
            <span class="n">synteny_struc</span><span class="o">=</span><span class="n">synteny_struc</span><span class="p">,</span>
            <span class="n">hmm_meta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="o">.</span><span class="n">hmm_meta</span><span class="p">,</span>
            <span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="o">.</span><span class="n">logfile</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run pynteny search</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">synteny_search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Search.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">synteny_struc</span><span class="p">,</span> <span class="n">gene_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reuse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hmm_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">hmmsearch_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Query sequence database for HMM hits arranged in provided synteny structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input labelled database.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>synteny_struc</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a str describing the desired synteny structure,
structured as follows:</p>
<p>'&gt;hmm_a N_ab hmm_b bc &lt;hmm_c'</p>
<p>where N_ab corresponds to the maximum number of genes separating 
gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds 
to the name of the hmm as provided in the keys of hmm_hits.
More than two hmms can be concatenated. Strand location may be
specificed by using '&gt;' for sense and '&lt;' for antisense. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>gene_ids</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether gene symbols are used in synteny 
string instead of HMM names. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>unordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether the HMMs should be arranged in the
exact same order displayed in the synteny_structure or in 
any order If ordered, the filters would filter collinear rather
than syntenic structures. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>reuse</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if True then HMMER3 won't be run again for HMMs already</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>hmm_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to directory containing input HMM files.
Defaults to None, in which case the PGAP database is downloaded if not
already so.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hmm_meta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to PGAP's metadata file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>outdir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output directory. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>prefix of output file names. Defaults to "".</p></td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>hmmsearch_args</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>additional arguments to hmmsearch or hmmscan. Each
element in the list is a string with additional arguments for each 
input hmm (arranged in the same order), an element can also take a 
value of None to avoid passing additional arguments for a specific 
input hmm. A single string may also be passed, in which case the 
same additional argument is passed to hmmsearch for all input hmms.
Defaults to None. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>logfile</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to log file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads to be employed.
Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">synteny_struc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">gene_ids</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">reuse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">hmm_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">outdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">hmmsearch_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">logfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Query sequence database for HMM hits arranged in provided synteny structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Path): path to input labelled database.</span>
<span class="sd">        synteny_struc (str): a str describing the desired synteny structure,</span>
<span class="sd">            structured as follows:</span>

<span class="sd">            &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">            where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">            gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">            to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">            More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">            specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">        gene_ids (bool, optional): whether gene symbols are used in synteny </span>
<span class="sd">            string instead of HMM names. Defaults to False.</span>
<span class="sd">        unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">            exact same order displayed in the synteny_structure or in </span>
<span class="sd">            any order If ordered, the filters would filter collinear rather</span>
<span class="sd">            than syntenic structures. Defaults to False.</span>
<span class="sd">        reuse (bool, optional): if True then HMMER3 won&#39;t be run again for HMMs already</span>
<span class="sd">        searched in the same output directory. Defaults to False.</span>
<span class="sd">        hmm_dir (Path, optional): path to directory containing input HMM files.</span>
<span class="sd">            Defaults to None, in which case the PGAP database is downloaded if not</span>
<span class="sd">            already so.</span>
<span class="sd">        hmm_meta (Path, optional): path to PGAP&#39;s metadata file. Defaults to None.</span>
<span class="sd">        outdir (Path, optional): path to output directory. Defaults to None.</span>
<span class="sd">        prefix (str, optional): prefix of output file names. Defaults to &quot;&quot;.</span>
<span class="sd">        hmmsearch_args (str, optional): additional arguments to hmmsearch or hmmscan. Each</span>
<span class="sd">            element in the list is a string with additional arguments for each </span>
<span class="sd">            input hmm (arranged in the same order), an element can also take a </span>
<span class="sd">            value of None to avoid passing additional arguments for a specific </span>
<span class="sd">            input hmm. A single string may also be passed, in which case the </span>
<span class="sd">            same additional argument is passed to hmmsearch for all input hmms.</span>
<span class="sd">            Defaults to None. Defaults to None.</span>
<span class="sd">        logfile (Path, optional): path to log file. Defaults to None.</span>
<span class="sd">        processes (int, optional): maximum number of threads to be employed.</span>
<span class="sd">            Defaults to all minus one.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="n">synteny_struc</span><span class="o">=</span><span class="n">synteny_struc</span><span class="p">,</span>
        <span class="n">hmm_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">hmm_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">hmm_dir</span><span class="p">,</span>
        <span class="n">hmm_meta</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span> <span class="k">if</span> <span class="n">hmm_meta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">hmm_meta</span><span class="p">,</span>
        <span class="n">outdir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span> <span class="k">if</span> <span class="n">outdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outdir</span><span class="p">,</span>
        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">hmmsearch_args</span><span class="o">=</span><span class="n">hmmsearch_args</span><span class="p">,</span>
        <span class="n">gene_ids</span><span class="o">=</span><span class="n">gene_ids</span><span class="p">,</span>
        <span class="n">logfile</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="k">if</span> <span class="n">logfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">logfile</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
        <span class="n">unordered</span><span class="o">=</span><span class="n">unordered</span><span class="p">,</span>
        <span class="n">reuse</span><span class="o">=</span><span class="n">reuse</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Search.parseGeneIDs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parseGeneIDs</span><span class="p">(</span><span class="n">synteny_struc</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse gene IDs in synteny structure and find corresponding HMM names
in provided HMM database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_struc</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a str describing the desired synteny structure,
structured as follows:</p>
<p>'&gt;hmm_a N_ab hmm_b bc &lt;hmm_c'</p>
<p>where N_ab corresponds to the maximum number of genes separating 
gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds 
to the name of the hmm as provided in the keys of hmm_hits.
More than two hmms can be concatenated. Strand location may be
specificed by using '&gt;' for sense and '&lt;' for antisense. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>parsed synteny structure in which gene symbols are replaced by 
 corresponding HMM names.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parseGeneIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_struc</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parse gene IDs in synteny structure and find corresponding HMM names</span>
<span class="sd">    in provided HMM database.</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_struc (str): a str describing the desired synteny structure,</span>
<span class="sd">            structured as follows:</span>

<span class="sd">            &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">            where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">            gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">            to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">            More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">            specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>

<span class="sd">    Returns:</span>
<span class="sd">        str: parsed synteny structure in which gene symbols are replaced by </span>
<span class="sd">             corresponding HMM names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span>
        <span class="n">synteny_struc</span><span class="o">=</span><span class="n">synteny_struc</span><span class="p">,</span>
        <span class="n">hmm_meta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="o">.</span><span class="n">hmm_meta</span><span class="p">,</span>
        <span class="n">logfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="o">.</span><span class="n">logfile</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.api.Search.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run pynteny search</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/api.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run pynteny search</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">synteny_search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="module-filter">Module filter</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.filter"></a>
  <div class="doc doc-contents first">
  
      <p>Tools to filter HMM hits by synteny structure</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.filter.SyntenyHMMfilter" class="doc doc-heading">
        <code>SyntenyHMMfilter</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Tools to search for synteny structures among sets of hmm models</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/filter.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SyntenyHMMfilter</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Tools to search for synteny structures among sets of hmm models</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_hits</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Search for contigs that satisfy the given gene synteny structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            hmm_hits (dict): a dict of pandas DataFrames, as output by</span>
<span class="sd">                parseHMMsearchOutput with keys corresponding to hmm names</span>
<span class="sd">            synteny_structure (str): a str describing the desired synteny structure,</span>
<span class="sd">                structured as follows:</span>

<span class="sd">                &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">                where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">                gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">                to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">                More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">                specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">            unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">                exact same order displayed in the synteny_structure or in </span>
<span class="sd">                any order If ordered, the filters would filter collinear rather</span>
<span class="sd">                than syntenic structures. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_hits</span> <span class="o">=</span> <span class="n">hmm_hits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hmms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hmm_hits</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">containsHMMgroups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Disregarding strand location as unordered structured selected&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_order_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])))</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hmm_order_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>

    <span class="k">def</span> <span class="nf">_assignCodeToHMM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_group_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">hmm_group_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hmm_group_name</span><span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">code</span> <span class="k">for</span> <span class="n">hmm_group</span><span class="p">,</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_order_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">hmm_group_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">hmm_group</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)))</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;HMM: </span><span class="si">{</span><span class="n">hmm_group_name</span><span class="si">}</span><span class="s2"> found in more than one hmm group in synteny structure&quot;</span>
            <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No code found for HMM: </span><span class="si">{</span><span class="n">hmm_group_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_addMetaCodesToHMMhits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_hit_labels</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Dataframe</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Dataframe</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add numeric codes for each hmm and strand, compute distance between genes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_hit_labels</span><span class="p">[</span><span class="s2">&quot;gene_pos_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">gene_pos</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;gene_pos_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># required for rolling (skips first nan)</span>
        <span class="n">all_hit_labels</span><span class="p">[</span><span class="s2">&quot;hmm_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_assignCodeToHMM</span><span class="p">)</span>
        <span class="n">all_hit_labels</span><span class="p">[</span><span class="s2">&quot;strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">strand</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">strand</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="s2">&quot;neg&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span>  <span class="s2">&quot;pos&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">all_hit_labels</span>

    <span class="k">def</span> <span class="nf">_mergeHitsByHMMgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hits</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Merge hit sequences within an HMM group representing</span>
<span class="sd">        the same gene symbol. Drop duplicated hits within </span>
<span class="sd">        each HMM group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;full_label&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">groups</span>
        <span class="k">for</span> <span class="n">group_idxs</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">hmm_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hits</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_idxs</span><span class="p">,</span> <span class="s2">&quot;hmm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">candidate_hmm_group</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">hmm_group_str</span> <span class="k">for</span> <span class="n">hmm_group_str</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">hmm_names</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">hmm_group_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)))</span>
                <span class="p">]</span>
            <span class="k">if</span> <span class="n">candidate_hmm_group</span><span class="p">:</span>
                <span class="n">hmm_group</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hmm_names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hmm_group</span> <span class="o">=</span> <span class="s2">&quot;discard&quot;</span>
            <span class="n">hits</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">group_idxs</span><span class="p">,</span> <span class="s2">&quot;hmm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmm_group</span>
        <span class="n">hits</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="n">hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">!=</span> <span class="s2">&quot;discard&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
        <span class="n">hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">hits</span>

    <span class="k">def</span> <span class="nf">getAllHMMhits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group and preprocess all hit labels into a single dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: HMMER3 hit labels matching provided HMMs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hit_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">labelparser</span> <span class="o">=</span> <span class="n">LabelParser</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">hmm</span><span class="p">,</span> <span class="n">hits</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;No records found in database matching HMM: </span><span class="si">{</span><span class="n">hmm</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelparser</span><span class="o">.</span><span class="n">parse_from_list</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">][</span><span class="s2">&quot;hmm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmm</span>
        <span class="c1"># Create single dataframe with new column corresponding to HMM and all hits</span>
        <span class="c1"># Remove contigs with less hits than the number of hmms in synteny structure (drop if enabling partial searching)</span>
        <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="n">hit_labels</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;contig&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span>
                <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;contig&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_pos&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hmm_groups</span><span class="p">:</span>
            <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mergeHitsByHMMgroup</span><span class="p">(</span><span class="n">all_hit_labels</span><span class="p">)</span>
        <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addMetaCodesToHMMhits</span><span class="p">(</span><span class="n">all_hit_labels</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filterHitsBySyntenyStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Search for contigs that satisfy the given gene synteny structure.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: HMMER3 hits separated by contig.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_matched_hits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">SyntenyPatternFilters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">)</span>
        <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAllHMMhits</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;At least two different HMMs produced identical sequence hits&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;All input profile HMMs rendered identical sequence hits. &quot;</span>
                    <span class="s2">&quot;Inspect HMMER output tables to evaluate hits.&quot;</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">contig_names</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">contig</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">contig</span> <span class="ow">in</span> <span class="n">contig_names</span><span class="p">:</span>
            <span class="n">contig_hits</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="p">[</span><span class="n">all_hit_labels</span><span class="o">.</span><span class="n">contig</span> <span class="o">==</span> <span class="n">contig</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">matched_hit_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">hmm_group</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">()}</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">:</span>

                <span class="n">hmm_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm_code</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">.</span><span class="n">contains_hmm_pattern</span>
                    <span class="p">)</span>
                <span class="n">strand_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">strand</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">.</span><span class="n">contains_strand_pattern</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">distance_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">gene_pos_diff</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
                        <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filters</span><span class="o">.</span><span class="n">contains_distance_pattern</span><span class="p">)</span>
                    <span class="n">matched_rows</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="p">[</span>
                        <span class="p">(</span><span class="n">hmm_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                        <span class="p">(</span><span class="n">strand_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                        <span class="p">(</span><span class="n">distance_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">matched_rows</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="p">[</span>
                        <span class="p">(</span><span class="n">hmm_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                        <span class="p">(</span><span class="n">strand_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">matched_rows</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="n">matched_hits</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="n">matched_hits</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">matched_hits</span><span class="o">.</span><span class="n">hmm</span><span class="p">):</span>
                        <span class="n">matched_hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

                <span class="n">all_matched_hits</span><span class="p">[</span><span class="n">contig</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_hit_labels</span>
        <span class="k">return</span> <span class="n">all_matched_hits</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHMMfilter.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hmm_hits</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Search for contigs that satisfy the given gene synteny structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_hits</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>a dict of pandas DataFrames, as output by
parseHMMsearchOutput with keys corresponding to hmm names</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a str describing the desired synteny structure,
structured as follows:</p>
<p>'&gt;hmm_a N_ab hmm_b bc &lt;hmm_c'</p>
<p>where N_ab corresponds to the maximum number of genes separating 
gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds 
to the name of the hmm as provided in the keys of hmm_hits.
More than two hmms can be concatenated. Strand location may be
specificed by using '&gt;' for sense and '&lt;' for antisense. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether the HMMs should be arranged in the
exact same order displayed in the synteny_structure or in 
any order If ordered, the filters would filter collinear rather
than syntenic structures. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_hits</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Search for contigs that satisfy the given gene synteny structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_hits (dict): a dict of pandas DataFrames, as output by</span>
<span class="sd">            parseHMMsearchOutput with keys corresponding to hmm names</span>
<span class="sd">        synteny_structure (str): a str describing the desired synteny structure,</span>
<span class="sd">            structured as follows:</span>

<span class="sd">            &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">            where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">            gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">            to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">            More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">            specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">        unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">            exact same order displayed in the synteny_structure or in </span>
<span class="sd">            any order If ordered, the filters would filter collinear rather</span>
<span class="sd">            than syntenic structures. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_hits</span> <span class="o">=</span> <span class="n">hmm_hits</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hmms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hmm_hits</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">containsHMMgroups</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Disregarding strand location as unordered structured selected&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_order_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])))</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hmm_order_dict</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHMMfilter.filterHitsBySyntenyStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filterHitsBySyntenyStructure</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Search for contigs that satisfy the given gene synteny structure.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>HMMER3 hits separated by contig.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filterHitsBySyntenyStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Search for contigs that satisfy the given gene synteny structure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: HMMER3 hits separated by contig.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_matched_hits</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="n">SyntenyPatternFilters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_structure</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">)</span>
    <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAllHMMhits</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;At least two different HMMs produced identical sequence hits&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;All input profile HMMs rendered identical sequence hits. &quot;</span>
                <span class="s2">&quot;Inspect HMMER output tables to evaluate hits.&quot;</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">contig_names</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">contig</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">contig</span> <span class="ow">in</span> <span class="n">contig_names</span><span class="p">:</span>
        <span class="n">contig_hits</span> <span class="o">=</span> <span class="n">all_hit_labels</span><span class="p">[</span><span class="n">all_hit_labels</span><span class="o">.</span><span class="n">contig</span> <span class="o">==</span> <span class="n">contig</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">matched_hit_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">hmm_group</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">()}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">:</span>

            <span class="n">hmm_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">hmm_code</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">.</span><span class="n">contains_hmm_pattern</span>
                <span class="p">)</span>
            <span class="n">strand_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">strand</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">.</span><span class="n">contains_strand_pattern</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">distance_match</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">gene_pos_diff</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
                    <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">filters</span><span class="o">.</span><span class="n">contains_distance_pattern</span><span class="p">)</span>
                <span class="n">matched_rows</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">hmm_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">strand_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">distance_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">matched_rows</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">hmm_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">strand_match</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">matched_rows</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">matched_hits</span> <span class="o">=</span> <span class="n">contig_hits</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="n">matched_hits</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">matched_hits</span><span class="o">.</span><span class="n">hmm</span><span class="p">):</span>
                    <span class="n">matched_hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

            <span class="n">all_matched_hits</span><span class="p">[</span><span class="n">contig</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_hit_labels</span>
    <span class="k">return</span> <span class="n">all_matched_hits</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHMMfilter.getAllHMMhits" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getAllHMMhits</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Group and preprocess all hit labels into a single dataframe.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: HMMER3 hit labels matching provided HMMs.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getAllHMMhits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Group and preprocess all hit labels into a single dataframe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: HMMER3 hit labels matching provided HMMs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hit_labels</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">labelparser</span> <span class="o">=</span> <span class="n">LabelParser</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">hmm</span><span class="p">,</span> <span class="n">hits</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hmm_hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">hits</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;No records found in database matching HMM: </span><span class="si">{</span><span class="n">hmm</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelparser</span><span class="o">.</span><span class="n">parse_from_list</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">hit_labels</span><span class="p">[</span><span class="n">hmm</span><span class="p">][</span><span class="s2">&quot;hmm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmm</span>
    <span class="c1"># Create single dataframe with new column corresponding to HMM and all hits</span>
    <span class="c1"># Remove contigs with less hits than the number of hmms in synteny structure (drop if enabling partial searching)</span>
    <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="n">hit_labels</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;contig&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_hmm_groups</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;contig&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_pos&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hmm_groups</span><span class="p">:</span>
        <span class="n">all_hit_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mergeHitsByHMMgroup</span><span class="p">(</span><span class="n">all_hit_labels</span><span class="p">)</span>
    <span class="n">all_hit_labels</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addMetaCodesToHMMhits</span><span class="p">(</span><span class="n">all_hit_labels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.filter.SyntenyHits" class="doc doc-heading">
        <code>SyntenyHits</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Store and manipulate synteny hits by contig</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/filter.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SyntenyHits</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Store and manipulate synteny hits by contig</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_hits</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize from synteny hits object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span> <span class="o">=</span> <span class="n">synteny_hits</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_hitsToDataframe</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return synteny hits as a dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;contig&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_id&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_number&quot;</span><span class="p">,</span> <span class="s2">&quot;locus&quot;</span><span class="p">,</span> <span class="s2">&quot;strand&quot;</span><span class="p">,</span> <span class="s2">&quot;full_label&quot;</span><span class="p">,</span> <span class="s2">&quot;hmm&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">contig</span><span class="p">,</span> <span class="n">matched_hits</span> <span class="ow">in</span> <span class="n">hits_by_contig</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">hmm</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">matched_hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                    <span class="n">parsed_label</span> <span class="o">=</span> <span class="n">LabelParser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">parsed_label</span><span class="p">[</span><span class="s1">&#39;contig&#39;</span><span class="p">],</span> <span class="n">parsed_label</span><span class="p">[</span><span class="s1">&#39;gene_id&#39;</span><span class="p">],</span>
                            <span class="n">parsed_label</span><span class="p">[</span><span class="s1">&#39;gene_pos&#39;</span><span class="p">],</span> <span class="n">parsed_label</span><span class="p">[</span><span class="s1">&#39;locus_pos&#39;</span><span class="p">],</span>
                            <span class="n">parsed_label</span><span class="p">[</span><span class="s1">&#39;strand&#39;</span><span class="p">],</span> <span class="n">parsed_label</span><span class="p">[</span><span class="s2">&quot;full_label&quot;</span><span class="p">],</span> <span class="n">hmm</span>
                            <span class="p">]</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;contig&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_number&quot;</span><span class="p">])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromHitsDict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hits_by_contig</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize SyntenyHits object from hits_by_contig dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            hits_by_contig (dict): HMMER3 hit labels separated by contig name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SyntenyHits: initialized object of class SyntenyHits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_hitsToDataframe</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">getSyntenyHits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return synteny hits.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Synteny hits as dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span>

    <span class="k">def</span> <span class="nf">addHMMmetaInfoToHits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add molecular metadata to synteny hits.</span>

<span class="sd">        Args:</span>
<span class="sd">            hmm_meta (Path): path to PGAP metadata file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SyntenyHits: and instance of class SyntenyHits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gene_symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;ec_number&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span>
        <span class="n">pgap</span> <span class="o">=</span> <span class="n">PGAP</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="n">fields</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">meta_values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> 
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pgap</span><span class="o">.</span><span class="n">getMetaInfoForHMM</span><span class="p">(</span><span class="n">hmm</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;#ncbi_accession&quot;</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">i</span><span class="p">,</span> <span class="n">fields</span>
                <span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">meta_values</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">SyntenyHits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writeToTSV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_tsv</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write synteny hits to a TSV file.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_tsv (Path): path to output tsv file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_tsv</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writeHitSequencesToFASTAfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence_database</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                                      <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                      <span class="n">output_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write matching sequences to FASTA files.</span>

<span class="sd">        Args:</span>
<span class="sd">            sequence_database (Path): path to the peptide or nucleotide sequence database</span>
<span class="sd">                in which the synteny search was conducted.</span>
<span class="sd">            output_dir (Path, optional): path to output directory. Defaults to None.</span>
<span class="sd">            output_prefix (str, optional): prefix for output files. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="p">(</span><span class="n">sequence_database</span><span class="p">)</span>
        <span class="n">hmm_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span><span class="p">:</span>
            <span class="n">record_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span>
                <span class="p">]</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;gene_symbol&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> 
                <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">gene_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span><span class="p">]</span><span class="o">.</span><span class="n">gene_symbol</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gene_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gene_id</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">gene_symbol</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">gene_label</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">gene_label</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gene_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">gene_id_str</span> <span class="o">=</span> <span class="n">gene_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">gene_id</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

            <span class="n">output_fasta</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}{</span><span class="n">gene_id_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}{</span><span class="n">hmm_group</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_hits.fasta&quot;</span>
            <span class="k">if</span> <span class="n">record_ids</span><span class="p">:</span>
                <span class="n">fasta</span><span class="o">.</span><span class="n">filterByIDs</span><span class="p">(</span>
                    <span class="n">record_ids</span><span class="o">=</span><span class="n">record_ids</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="o">=</span><span class="n">output_fasta</span><span class="p">,</span>
                    <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">False</span>

                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No record matches found in synteny structure for HMM: </span><span class="si">{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">synteny_hits</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize from synteny hits object.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_hits</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize from synteny hits object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span> <span class="o">=</span> <span class="n">synteny_hits</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.addHMMmetaInfoToHits" class="doc doc-heading">
<code class="highlight language-python"><span class="n">addHMMmetaInfoToHits</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add molecular metadata to synteny hits.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_meta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to PGAP metadata file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SyntenyHits</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.filter.SyntenyHits" href="#pynteny.filter.SyntenyHits">SyntenyHits</a></code>
          </td>
          <td><p>and instance of class SyntenyHits.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">addHMMmetaInfoToHits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add molecular metadata to synteny hits.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_meta (Path): path to PGAP metadata file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SyntenyHits: and instance of class SyntenyHits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;gene_symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;ec_number&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span>
    <span class="n">pgap</span> <span class="o">=</span> <span class="n">PGAP</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="n">fields</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">meta_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> 
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pgap</span><span class="o">.</span><span class="n">getMetaInfoForHMM</span><span class="p">(</span><span class="n">hmm</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;#ncbi_accession&quot;</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">fields</span>
            <span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">meta_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">SyntenyHits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.fromHitsDict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fromHitsDict</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize SyntenyHits object from hits_by_contig dictionary.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hits_by_contig</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>HMMER3 hit labels separated by contig name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SyntenyHits</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.filter.SyntenyHits" href="#pynteny.filter.SyntenyHits">SyntenyHits</a></code>
          </td>
          <td><p>initialized object of class SyntenyHits.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromHitsDict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hits_by_contig</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize SyntenyHits object from hits_by_contig dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        hits_by_contig (dict): HMMER3 hit labels separated by contig name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SyntenyHits: initialized object of class SyntenyHits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_hitsToDataframe</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.getSyntenyHits" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getSyntenyHits</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return synteny hits.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: Synteny hits as dataframe.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getSyntenyHits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return synteny hits.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Synteny hits as dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.writeHitSequencesToFASTAfiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">writeHitSequencesToFASTAfiles</span><span class="p">(</span><span class="n">sequence_database</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write matching sequences to FASTA files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sequence_database</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to the peptide or nucleotide sequence database
in which the synteny search was conducted.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output directory. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>prefix for output files. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">writeHitSequencesToFASTAfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence_database</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                                  <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">output_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Write matching sequences to FASTA files.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence_database (Path): path to the peptide or nucleotide sequence database</span>
<span class="sd">            in which the synteny search was conducted.</span>
<span class="sd">        output_dir (Path, optional): path to output directory. Defaults to None.</span>
<span class="sd">        output_prefix (str, optional): prefix for output files. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="p">(</span><span class="n">sequence_database</span><span class="p">)</span>
    <span class="n">hmm_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span><span class="p">:</span>
        <span class="n">record_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span>
            <span class="p">]</span><span class="o">.</span><span class="n">full_label</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;gene_symbol&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> 
            <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">gene_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span><span class="p">]</span><span class="o">.</span><span class="n">gene_symbol</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gene_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">hmm</span> <span class="o">==</span> <span class="n">hmm_group</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gene_id</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">gene_symbol</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">(</span><span class="n">gene_label</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">gene_label</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gene_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">gene_id_str</span> <span class="o">=</span> <span class="n">gene_id</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="k">if</span> <span class="n">gene_id</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">output_fasta</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}{</span><span class="n">gene_id_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}{</span><span class="n">hmm_group</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_hits.fasta&quot;</span>
        <span class="k">if</span> <span class="n">record_ids</span><span class="p">:</span>
            <span class="n">fasta</span><span class="o">.</span><span class="n">filterByIDs</span><span class="p">(</span>
                <span class="n">record_ids</span><span class="o">=</span><span class="n">record_ids</span><span class="p">,</span>
                <span class="n">output_file</span><span class="o">=</span><span class="n">output_fasta</span><span class="p">,</span>
                <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">False</span>

            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No record matches found in synteny structure for HMM: </span><span class="si">{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyHits.writeToTSV" class="doc doc-heading">
<code class="highlight language-python"><span class="n">writeToTSV</span><span class="p">(</span><span class="n">output_tsv</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write synteny hits to a TSV file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_tsv</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output tsv file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">writeToTSV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_tsv</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Write synteny hits to a TSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_tsv (Path): path to output tsv file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_synteny_hits</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_tsv</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.filter.SyntenyPatternFilters" class="doc doc-heading">
        <code>SyntenyPatternFilters</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Methods to filter hmm hits in the  same contig by synteny structure
or collinearity. These filters are inputs to pandas.Dataframe.rolling method.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/filter.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SyntenyPatternFilters</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Methods to filter hmm hits in the  same contig by synteny structure</span>
<span class="sd">       or collinearity. These filters are inputs to pandas.Dataframe.rolling method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize filter class from synteny structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            synteny_structure (str): a str describing the desired synteny structure,</span>
<span class="sd">                structured as follows:</span>

<span class="sd">                &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">                where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">                gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">                to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">                More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">                specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">            unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">                exact same order displayed in the synteny_structure or in </span>
<span class="sd">                any order If ordered, the filters would filter collinear rather</span>
<span class="sd">                than syntenic structures. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_structure</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="n">hmm_order_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])))</span>
            <span class="p">)</span>
        <span class="n">hmm_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hmm_order_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span> <span class="o">=</span> <span class="n">hmm_codes</span>

        <span class="k">if</span> <span class="n">unordered</span><span class="p">:</span>
            <span class="n">max_distance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span>
            <span class="n">max_distances</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">max_distance</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_distances</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span>
        <span class="n">min_distances</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_order_pattern</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">min_distances</span><span class="p">,</span> <span class="n">max_distances</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">strand_order_pattern</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">strand</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="s2">&quot;neg&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span>  <span class="s2">&quot;pos&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]</span>
            <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>

    <span class="k">def</span> <span class="nf">contains_hmm_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check if series items contain a profile HMM</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.Series): a series resulting from calling rolling on a pandas column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: 1 for True 0 for False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">contains_distance_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.Series): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">data_dist</span> <span class="o">&lt;=</span> <span class="n">max_dist</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data_dist</span> <span class="o">&gt;</span> <span class="n">min_dist</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">data_dist</span><span class="p">,</span> <span class="p">(</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_order_pattern</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">contains_strand_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pd.Series): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: _description_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strand_comparisons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data_strand</span><span class="p">,</span> <span class="n">pattern_strand</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">strand_order_pattern</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pattern_strand</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">strand_comparisons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_strand</span> <span class="o">==</span> <span class="n">pattern_strand</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">strand_comparisons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">strand_comparisons</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyPatternFilters.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize filter class from synteny structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a str describing the desired synteny structure,
structured as follows:</p>
<p>'&gt;hmm_a N_ab hmm_b bc &lt;hmm_c'</p>
<p>where N_ab corresponds to the maximum number of genes separating 
gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds 
to the name of the hmm as provided in the keys of hmm_hits.
More than two hmms can be concatenated. Strand location may be
specificed by using '&gt;' for sense and '&lt;' for antisense. </p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether the HMMs should be arranged in the
exact same order displayed in the synteny_structure or in 
any order If ordered, the filters would filter collinear rather
than syntenic structures. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize filter class from synteny structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_structure (str): a str describing the desired synteny structure,</span>
<span class="sd">            structured as follows:</span>

<span class="sd">            &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">            where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">            gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">            to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">            More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">            specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense. </span>
<span class="sd">        unordered (bool, optional): whether the HMMs should be arranged in the</span>
<span class="sd">            exact same order displayed in the synteny_structure or in </span>
<span class="sd">            any order If ordered, the filters would filter collinear rather</span>
<span class="sd">            than syntenic structures. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_structure</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="n">hmm_order_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])))</span>
        <span class="p">)</span>
    <span class="n">hmm_codes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hmm_order_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span> <span class="o">=</span> <span class="n">hmm_codes</span>

    <span class="k">if</span> <span class="n">unordered</span><span class="p">:</span>
        <span class="n">max_distance</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span>
        <span class="n">max_distances</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">max_distance</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_distances</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]</span>
    <span class="n">min_distances</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distance_order_pattern</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">min_distances</span><span class="p">,</span> <span class="n">max_distances</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">strand_order_pattern</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">strand</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="s2">&quot;neg&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span>  <span class="s2">&quot;pos&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">parsed_structure</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">]</span>
        <span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span> <span class="o">=</span> <span class="n">unordered</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyPatternFilters.contains_distance_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">contains_distance_pattern</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p><em>summary</em></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td><p><em>description</em></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td><p><em>description</em></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains_distance_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.Series): _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">(</span><span class="n">data_dist</span> <span class="o">&lt;=</span> <span class="n">max_dist</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">data_dist</span> <span class="o">&gt;</span> <span class="n">min_dist</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">data_dist</span><span class="p">,</span> <span class="p">(</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_order_pattern</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyPatternFilters.contains_hmm_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">contains_hmm_pattern</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if series items contain a profile HMM</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td><p>a series resulting from calling rolling on a pandas column.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td><p>1 for True 0 for False.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains_hmm_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if series items contain a profile HMM</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.Series): a series resulting from calling rolling on a pandas column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: 1 for True 0 for False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unordered</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">hmm_code_order_pattern</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.filter.SyntenyPatternFilters.contains_strand_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">contains_strand_pattern</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p><em>summary</em></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td><p><em>description</em></p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td><p><em>description</em></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains_strand_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;_summary_</span>

<span class="sd">    Args:</span>
<span class="sd">        data (pd.Series): _description_</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strand_comparisons</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_strand</span><span class="p">,</span> <span class="n">pattern_strand</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">strand_order_pattern</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pattern_strand</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">strand_comparisons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_strand</span> <span class="o">==</span> <span class="n">pattern_strand</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">strand_comparisons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">strand_comparisons</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pynteny.filter.filterFASTAbySyntenyStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filterFASTAbySyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">,</span> <span class="n">input_fasta</span><span class="p">,</span> <span class="n">input_hmms</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hmmer_output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reuse_hmmer_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hmmsearch&#39;</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generate protein-specific database by filtering sequence database
   to only contain sequences which satisfy the provided (gene/hmm) structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a str describing the desired synteny structure,
structured as follows:</p>
<p>'&gt;hmm_a N_ab hmm_b bc &lt;hmm_c'</p>
<p>where N_ab corresponds to the maximum number of genes separating 
gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds 
to the name of the hmm as provided in the keys of hmm_hits.
More than two hmms can be concatenated. Strand location may be
specificed by using '&gt;' for sense and '&lt;' for antisense.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_fasta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>input fasta containing sequence database to be searched.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_hmms</code></td>
          <td>
                <code>list[<span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>list containing paths to hmms contained in synteny structure.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unordered</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether HMM hits should follow the exact order
displayed in the synteny structure string or not, i.e., whether
to search for only synteny (colocation) or collinearity as well
(same order). Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>hmm_meta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to PGAP's metadata file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hmmer_output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>output directory to store HMMER3 output files. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>reuse_hmmer_results</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if True then HMMER3 won't be run again for HMMs already
searched in the same output directory. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>select between 'hmmsearch' or 'hmmscan'. Defaults to 'hmmsearch'.</p></td>
          <td>
                <code>&#39;hmmsearch&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads to be employed. Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>additional_args</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>additional arguments to hmmsearch or hmmscan. Each
element in the list is a string with additional arguments for each 
input hmm (arranged in the same order), an element can also take a 
value of None to avoid passing additional arguments for a specific 
input hmm. A single string may also be passed, in which case the 
same additional argument is passed to hmmsearch for all input hmms. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SyntenyHits</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.filter.SyntenyHits" href="#pynteny.filter.SyntenyHits">SyntenyHits</a></code>
          </td>
          <td><p>object of class SyntenyHits containing labels matching synteny structure.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filterFASTAbySyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                  <span class="n">input_fasta</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                                  <span class="n">input_hmms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span>
                                  <span class="n">unordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">hmmer_output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">reuse_hmmer_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hmmsearch&#39;</span><span class="p">,</span>
                                  <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                  <span class="n">additional_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Generate protein-specific database by filtering sequence database</span>
<span class="sd">       to only contain sequences which satisfy the provided (gene/hmm) structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_structure (str): a str describing the desired synteny structure,</span>
<span class="sd">            structured as follows:</span>

<span class="sd">            &#39;&gt;hmm_a N_ab hmm_b bc &lt;hmm_c&#39;</span>

<span class="sd">            where N_ab corresponds to the maximum number of genes separating </span>
<span class="sd">            gene found by hmm_a and gene found by hmm_b, and hmm_ corresponds </span>
<span class="sd">            to the name of the hmm as provided in the keys of hmm_hits.</span>
<span class="sd">            More than two hmms can be concatenated. Strand location may be</span>
<span class="sd">            specificed by using &#39;&gt;&#39; for sense and &#39;&lt;&#39; for antisense.</span>
<span class="sd">        input_fasta (Path): input fasta containing sequence database to be searched.</span>
<span class="sd">        input_hmms (list[Path]): list containing paths to hmms contained in synteny structure.</span>
<span class="sd">        unordered (bool, optional): whether HMM hits should follow the exact order</span>
<span class="sd">            displayed in the synteny structure string or not, i.e., whether</span>
<span class="sd">            to search for only synteny (colocation) or collinearity as well</span>
<span class="sd">            (same order). Defaults to False.</span>
<span class="sd">        hmm_meta (Path, optional): path to PGAP&#39;s metadata file. Defaults to None.</span>
<span class="sd">        hmmer_output_dir (Path, optional): output directory to store HMMER3 output files. Defaults to None.</span>
<span class="sd">        reuse_hmmer_results (bool, optional): if True then HMMER3 won&#39;t be run again for HMMs already</span>
<span class="sd">            searched in the same output directory. Defaults to True.</span>
<span class="sd">        method (str, optional): select between &#39;hmmsearch&#39; or &#39;hmmscan&#39;. Defaults to &#39;hmmsearch&#39;.</span>
<span class="sd">        processes (int, optional): maximum number of threads to be employed. Defaults to all minus one.</span>
<span class="sd">        additional_args (list[str], optional): additional arguments to hmmsearch or hmmscan. Each</span>
<span class="sd">            element in the list is a string with additional arguments for each </span>
<span class="sd">            input hmm (arranged in the same order), an element can also take a </span>
<span class="sd">            value of None to avoid passing additional arguments for a specific </span>
<span class="sd">            input hmm. A single string may also be passed, in which case the </span>
<span class="sd">            same additional argument is passed to hmmsearch for all input hmms. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SyntenyHits: object of class SyntenyHits containing labels matching synteny structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hmmer_output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hmmer_output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_fasta</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;hmmer_outputs&quot;</span>

    <span class="k">if</span> <span class="n">additional_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">additional_args</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">input_hmms</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">additional_args</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Repeating hmmsearch arg: &#39;</span><span class="si">{</span><span class="n">additional_args</span><span class="si">}</span><span class="s2">&#39; for all HMMs&quot;</span><span class="p">)</span>
        <span class="n">additional_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">additional_args</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">input_hmms</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">additional_args</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">additional_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Repeating hmmsearch arg: &#39;</span><span class="si">{</span><span class="n">additional_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; for all HMMs&quot;</span><span class="p">)</span>
            <span class="n">additional_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">additional_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">input_hmms</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">additional_args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">additional_args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_hmms</span><span class="p">)):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Provided additional argument strings are less than the number of input hmms.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Additional arguments must be: 1) a list[str], 2) a str, or 3) None&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">hmmer_output_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">hmmer_output_dir</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Running Hmmer&#39;</span><span class="p">)</span>
    <span class="n">hmmer</span> <span class="o">=</span> <span class="n">HMMER</span><span class="p">(</span>
        <span class="n">input_hmms</span><span class="o">=</span><span class="n">input_hmms</span><span class="p">,</span>
        <span class="n">input_data</span><span class="o">=</span><span class="n">input_fasta</span><span class="p">,</span>
        <span class="n">hmm_output_dir</span><span class="o">=</span><span class="n">hmmer_output_dir</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
        <span class="n">additional_args</span><span class="o">=</span><span class="n">additional_args</span>
    <span class="p">)</span>
    <span class="n">hmm_hits</span> <span class="o">=</span> <span class="n">hmmer</span><span class="o">.</span><span class="n">getHMMERtables</span><span class="p">(</span>
        <span class="n">reuse_hmmer_results</span><span class="o">=</span><span class="n">reuse_hmmer_results</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span>
    <span class="p">)</span>
    <span class="n">hmms_without_hits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">hmm_name</span><span class="p">,</span> <span class="n">hmmer_hits</span> <span class="ow">in</span> <span class="n">hmm_hits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">hmmer_hits</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">hmms_without_hits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hmm_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hmms_without_hits</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">hmm_name</span> <span class="ow">in</span> <span class="n">hmms_without_hits</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No records found in database matching HMM: </span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Filtering results by synteny structure&#39;</span><span class="p">)</span>
    <span class="n">syntenyfilter</span> <span class="o">=</span> <span class="n">SyntenyHMMfilter</span><span class="p">(</span><span class="n">hmm_hits</span><span class="p">,</span> <span class="n">synteny_structure</span><span class="p">,</span> <span class="n">unordered</span><span class="o">=</span><span class="n">unordered</span><span class="p">)</span>
    <span class="n">hits_by_contig</span> <span class="o">=</span> <span class="n">syntenyfilter</span><span class="o">.</span><span class="n">filterHitsBySyntenyStructure</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hmm_meta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SyntenyHits</span><span class="o">.</span><span class="n">fromHitsDict</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">)</span><span class="o">.</span><span class="n">addHMMmetaInfoToHits</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SyntenyHits</span><span class="o">.</span><span class="n">fromHitsDict</span><span class="p">(</span><span class="n">hits_by_contig</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-preprocessing">Module preprocessing</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.preprocessing"></a>
  <div class="doc doc-contents first">
  
      <p>Tools to preprocess sequence databases</p>
<ol>
<li>Remove illegal characters from peptide sequences</li>
<li>Remove illegal symbols from file paths</li>
<li>Relabel fasta records and make dictionary with old labels</li>
</ol>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.preprocessing.Database" class="doc doc-heading">
        <code>Database</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>_Sequence database constructor</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Database</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;_Sequence database constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize Database object</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Path): path to either assembly fasta file (or a</span>
<span class="sd">                         directory containing assembly fasta files) or</span>
<span class="sd">                         a genbank file containing ORF annotations (or a</span>
<span class="sd">                         directory containing genbank files)</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: if file or directory doesn&#39;t exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">/</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_fasta</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if file is in fasta format</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (Path): path to input file</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: whether the file is in fasta format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">fasta</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;fasta&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">fasta</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_gbk</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if file is in genbank format</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (Path): path to input file</span>

<span class="sd">        Returns:</span>
<span class="sd">            _type_: whether the file is in genbank format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">gbk</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;genbank&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">gbk</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Build database from data files.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_file (Path, optional): path to output file. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_labelled.faa&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">assembly_fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="o">.</span><span class="n">fromFASTAdirectory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">assembly_fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Translating and annotating assembly data.&quot;</span><span class="p">)</span>
            <span class="n">labelled_database</span> <span class="o">=</span> <span class="n">GeneAnnotator</span><span class="p">(</span>
                <span class="n">assembly_fasta</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gbk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing GenBank data.&quot;</span><span class="p">)</span>
            <span class="n">labelled_database</span> <span class="o">=</span> <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">fromGenBankData</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="si">}</span><span class="s2"> is not a valid FASTA or genbank file&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labelled_database</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.Database.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize Database object</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to either assembly fasta file (or a
         directory containing assembly fasta files) or
         a genbank file containing ORF annotations (or a
         directory containing genbank files)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>FileNotFoundError</code>
          </td>
          <td><p>if file or directory doesn't exist</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize Database object</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Path): path to either assembly fasta file (or a</span>
<span class="sd">                     directory containing assembly fasta files) or</span>
<span class="sd">                     a genbank file containing ORF annotations (or a</span>
<span class="sd">                     directory containing genbank files)</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: if file or directory doesn&#39;t exist</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">/</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.Database.build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Build database from data files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>LabelledFASTA</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.LabelledFASTA" href="#pynteny.preprocessing.LabelledFASTA">LabelledFASTA</a></code>
          </td>
          <td><p>object containing the labelled peptide database.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Build database from data files.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_file (Path, optional): path to output file. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_labelled.faa&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">assembly_fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="o">.</span><span class="n">fromFASTAdirectory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assembly_fasta</span> <span class="o">=</span> <span class="n">FASTA</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Translating and annotating assembly data.&quot;</span><span class="p">)</span>
        <span class="n">labelled_database</span> <span class="o">=</span> <span class="n">GeneAnnotator</span><span class="p">(</span>
            <span class="n">assembly_fasta</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_gbk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing GenBank data.&quot;</span><span class="p">)</span>
        <span class="n">labelled_database</span> <span class="o">=</span> <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">fromGenBankData</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="si">}</span><span class="s2"> is not a valid FASTA or genbank file&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">labelled_database</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.Database.is_fasta" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_fasta</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if file is in fasta format</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input file</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
          </td>
          <td><p>whether the file is in fasta format</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">is_fasta</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if file is in fasta format</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (Path): path to input file</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: whether the file is in fasta format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">fasta</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;fasta&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">fasta</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.Database.is_gbk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_gbk</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if file is in genbank format</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input file</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>_type_</code></td>          <td>
          </td>
          <td><p>whether the file is in genbank format</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">is_gbk</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if file is in genbank format</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (Path): path to input file</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: whether the file is in genbank format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">gbk</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;genbank&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">gbk</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.preprocessing.FASTA" class="doc doc-heading">
        <code>FASTA</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Handle and process fasta files.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FASTA</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Handle and process fasta files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize FASTA object.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_file (Path): path to input fasta file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setFilePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set new path to fasta file</span>

<span class="sd">        Args:</span>
<span class="sd">            new_path (Path): path to fasta file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getFilePath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;get path to fasta file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: path to fasta file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromFASTAdirectory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                           <span class="n">merged_fasta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FASTA</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize FASTA class from directory of fasta files.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_dir (Path): path to input directory.</span>
<span class="sd">            merged_fasta (Path, optional): path to output merged fasta. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            FASTA: an initialized instance of class FASTA.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">merged_fasta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">merged_fasta</span> <span class="o">=</span> <span class="n">input_dir</span> <span class="o">/</span> <span class="s2">&quot;merged_database.fasta&quot;</span>
        <span class="n">FASTA</span><span class="o">.</span><span class="n">mergeFASTAs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">merged_fasta</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">merged_fasta</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">mergeFASTAs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Merge input fasta files into a one (multi)fasta file.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_dir (Path): path to input directory</span>
<span class="sd">            output_file (Path, optional): path to ouput merged fasta file. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">input_dir</span> <span class="o">/</span> <span class="s2">&quot;merged.fasta&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merging FASTA files in input directory&quot;</span><span class="p">)</span>
        <span class="c1"># cmd_str = f&#39;awk 1 * &gt; {output_file}&#39;</span>
        <span class="c1"># # cmd_str = &quot;find . -maxdepth 1 -type f --exec cat {} + &gt; &quot; + f&quot;{output_file}&quot;</span>
        <span class="n">cmd_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;printf &#39;%s</span><span class="se">\\</span><span class="s2">0&#39; * | xargs -0 cat &gt; </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">terminalExecute</span><span class="p">(</span>
            <span class="n">cmd_str</span><span class="p">,</span>
            <span class="n">work_dir</span><span class="o">=</span><span class="n">input_dir</span><span class="p">,</span>
            <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeDuplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">export_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;seqkit&#39;</span><span class="p">,</span>
                         <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes duplicate entries (either by sequence or ID) from fasta.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">            export_duplicates (bool, optional): whether duplicated records are exported to a file. Defaults to False.</span>
<span class="sd">            method (str, optional): choose method to select duplicates: &#39;biopython&#39; or &#39;seqkit&#39;. Defaults to &#39;seqkit&#39;.</span>
<span class="sd">            point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>

<span class="sd">        Yields:</span>
<span class="sd">            None: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
                <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_noduplicates</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;bio&#39;</span> <span class="ow">in</span> <span class="n">method</span><span class="p">:</span>
            <span class="n">seen_seqs</span><span class="p">,</span> <span class="n">seen_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">def</span> <span class="nf">unique_records</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">,</span> <span class="s1">&#39;fasta&#39;</span><span class="p">):</span>  
                    <span class="k">if</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">seq</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_seqs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_ids</span><span class="p">):</span>
                        <span class="n">seen_seqs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
                        <span class="n">seen_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                        <span class="k">yield</span> <span class="n">record</span>
            <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">unique_records</span><span class="p">(),</span> <span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;fasta&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wrappers</span><span class="o">.</span><span class="n">runSeqKitNoDup</span><span class="p">(</span><span class="n">input_fasta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">,</span> <span class="n">output_fasta</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                    <span class="n">export_duplicates</span><span class="o">=</span><span class="n">export_duplicates</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeCorruptedSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                 <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                 <span class="n">is_peptide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                 <span class="n">keep_stop_codon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                 <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Filter out (DNA or peptide) sequences containing illegal characters.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">            is_peptide (bool, optional): select if input is a peptide sequence, otherwise taken as nucleotide. Defaults to True.</span>
<span class="sd">            keep_stop_codon (bool, optional): whether to keep the stop codon in the peptide sequence. Defaults to False.</span>
<span class="sd">            point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">fname</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">_modified</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">is_peptide</span><span class="p">:</span>
            <span class="n">isLegitSequence</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">isLegitPeptideSequence</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">isLegitSequence</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">isLegitDNAsequence</span>

        <span class="n">fasta</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">fasta</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_peptide</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keep_stop_codon</span><span class="p">):</span>
                    <span class="n">record_seq</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">removeStopCodonSignals</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isLegitSequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">):</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&gt;</span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">record_seq</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filterByIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Filter records in fasta file matching provided IDs.</span>

<span class="sd">        Args:</span>
<span class="sd">            record_ids (list): list of record IDs to keep of original fasta file.</span>
<span class="sd">            output_file (Path, optional): path to output filtered fasta file. Defaults to None.</span>
<span class="sd">            point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
                <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_filtered</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+t&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_ids</span><span class="p">:</span>
            <span class="n">tmp_ids</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">record_ids</span><span class="p">))</span>
            <span class="n">tmp_ids</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">tmp_ids_path</span> <span class="o">=</span> <span class="n">tmp_ids</span><span class="o">.</span><span class="n">name</span>
            <span class="n">cmd_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;seqkit grep -i -f </span><span class="si">{</span><span class="n">tmp_ids_path</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="si">}</span><span class="s2"> -o </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">splitByContigs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Split large fasta file into several ones containing one contig each.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_dir (Path, optional): _description_. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;split_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">contigs</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">contig_name</span><span class="p">,</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">contigs</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contig_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">contig_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seq</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filterByMinimumLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                              <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Filter records in fasta file by minimum length.</span>

<span class="sd">        Args:</span>
<span class="sd">            min_length (int): minimal length of sequences to be kept in filtered fasta file.</span>
<span class="sd">            output_file (Path, optional): path to output filtered fasta file. Defaults to None.</span>
<span class="sd">            point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
                <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_minlength</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">fasta</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">fasta</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">min_length</span><span class="p">:</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&gt;</span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">record_seq</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize FASTA object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input fasta file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize FASTA object.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (Path): path to input fasta file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.filterByIDs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filterByIDs</span><span class="p">(</span><span class="n">record_ids</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Filter records in fasta file matching provided IDs.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>record_ids</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list of record IDs to keep of original fasta file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output filtered fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>point_to_new_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether FASTA object should point to the newly generated file. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filterByIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Filter records in fasta file matching provided IDs.</span>

<span class="sd">    Args:</span>
<span class="sd">        record_ids (list): list of record IDs to keep of original fasta file.</span>
<span class="sd">        output_file (Path, optional): path to output filtered fasta file. Defaults to None.</span>
<span class="sd">        point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
            <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_filtered</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+t&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_ids</span><span class="p">:</span>
        <span class="n">tmp_ids</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">record_ids</span><span class="p">))</span>
        <span class="n">tmp_ids</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">tmp_ids_path</span> <span class="o">=</span> <span class="n">tmp_ids</span><span class="o">.</span><span class="n">name</span>
        <span class="n">cmd_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;seqkit grep -i -f </span><span class="si">{</span><span class="n">tmp_ids_path</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="si">}</span><span class="s2"> -o </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.filterByMinimumLength" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filterByMinimumLength</span><span class="p">(</span><span class="n">min_length</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Filter records in fasta file by minimum length.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>min_length</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>minimal length of sequences to be kept in filtered fasta file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output filtered fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>point_to_new_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether FASTA object should point to the newly generated file. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filterByMinimumLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                          <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Filter records in fasta file by minimum length.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_length (int): minimal length of sequences to be kept in filtered fasta file.</span>
<span class="sd">        output_file (Path, optional): path to output filtered fasta file. Defaults to None.</span>
<span class="sd">        point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
            <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_minlength</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">fasta</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">fasta</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">min_length</span><span class="p">:</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&gt;</span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">record_seq</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.fromFASTAdirectory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fromFASTAdirectory</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">merged_fasta</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize FASTA class from directory of fasta files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input directory.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>merged_fasta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output merged fasta. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>FASTA</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.FASTA" href="#pynteny.preprocessing.FASTA">FASTA</a></code>
          </td>
          <td><p>an initialized instance of class FASTA.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromFASTAdirectory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                       <span class="n">merged_fasta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FASTA</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize FASTA class from directory of fasta files.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dir (Path): path to input directory.</span>
<span class="sd">        merged_fasta (Path, optional): path to output merged fasta. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        FASTA: an initialized instance of class FASTA.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">merged_fasta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">merged_fasta</span> <span class="o">=</span> <span class="n">input_dir</span> <span class="o">/</span> <span class="s2">&quot;merged_database.fasta&quot;</span>
    <span class="n">FASTA</span><span class="o">.</span><span class="n">mergeFASTAs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">merged_fasta</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">merged_fasta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.getFilePath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getFilePath</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>get path to fasta file.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Path</code></td>          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to fasta file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getFilePath</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;get path to fasta file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: path to fasta file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.mergeFASTAs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mergeFASTAs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Merge input fasta files into a one (multi)fasta file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input directory</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to ouput merged fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">mergeFASTAs</span><span class="p">(</span><span class="n">input_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Merge input fasta files into a one (multi)fasta file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dir (Path): path to input directory</span>
<span class="sd">        output_file (Path, optional): path to ouput merged fasta file. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">input_dir</span> <span class="o">/</span> <span class="s2">&quot;merged.fasta&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merging FASTA files in input directory&quot;</span><span class="p">)</span>
    <span class="c1"># cmd_str = f&#39;awk 1 * &gt; {output_file}&#39;</span>
    <span class="c1"># # cmd_str = &quot;find . -maxdepth 1 -type f --exec cat {} + &gt; &quot; + f&quot;{output_file}&quot;</span>
    <span class="n">cmd_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;printf &#39;%s</span><span class="se">\\</span><span class="s2">0&#39; * | xargs -0 cat &gt; </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">terminalExecute</span><span class="p">(</span>
        <span class="n">cmd_str</span><span class="p">,</span>
        <span class="n">work_dir</span><span class="o">=</span><span class="n">input_dir</span><span class="p">,</span>
        <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.removeCorruptedSequences" class="doc doc-heading">
<code class="highlight language-python"><span class="n">removeCorruptedSequences</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_peptide</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_stop_codon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Filter out (DNA or peptide) sequences containing illegal characters.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>is_peptide</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>select if input is a peptide sequence, otherwise taken as nucleotide. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>keep_stop_codon</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to keep the stop codon in the peptide sequence. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>point_to_new_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether FASTA object should point to the newly generated file. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">removeCorruptedSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">is_peptide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="n">keep_stop_codon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Filter out (DNA or peptide) sequences containing illegal characters.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">        is_peptide (bool, optional): select if input is a peptide sequence, otherwise taken as nucleotide. Defaults to True.</span>
<span class="sd">        keep_stop_codon (bool, optional): whether to keep the stop codon in the peptide sequence. Defaults to False.</span>
<span class="sd">        point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dirname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">fname</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">_modified</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">is_peptide</span><span class="p">:</span>
        <span class="n">isLegitSequence</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">isLegitPeptideSequence</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isLegitSequence</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">isLegitDNAsequence</span>

    <span class="n">fasta</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">fasta</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_peptide</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keep_stop_codon</span><span class="p">):</span>
                <span class="n">record_seq</span> <span class="o">=</span> <span class="n">RecordSequence</span><span class="o">.</span><span class="n">removeStopCodonSignals</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isLegitSequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">):</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&gt;</span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">record_seq</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.removeDuplicates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">removeDuplicates</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">export_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;seqkit&#39;</span><span class="p">,</span> <span class="n">point_to_new_file</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Removes duplicate entries (either by sequence or ID) from fasta.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>export_duplicates</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether duplicated records are exported to a file. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>choose method to select duplicates: 'biopython' or 'seqkit'. Defaults to 'seqkit'.</p></td>
          <td>
                <code>&#39;seqkit&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>point_to_new_file</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether FASTA object should point to the newly generated file. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">removeDuplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">export_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;seqkit&#39;</span><span class="p">,</span>
                     <span class="n">point_to_new_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Removes duplicate entries (either by sequence or ID) from fasta.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">        export_duplicates (bool, optional): whether duplicated records are exported to a file. Defaults to False.</span>
<span class="sd">        method (str, optional): choose method to select duplicates: &#39;biopython&#39; or &#39;seqkit&#39;. Defaults to &#39;seqkit&#39;.</span>
<span class="sd">        point_to_new_file (bool, optional): whether FASTA object should point to the newly generated file. Defaults to True.</span>

<span class="sd">    Yields:</span>
<span class="sd">        None: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> \
            <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_noduplicates</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="s1">&#39;bio&#39;</span> <span class="ow">in</span> <span class="n">method</span><span class="p">:</span>
        <span class="n">seen_seqs</span><span class="p">,</span> <span class="n">seen_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">def</span> <span class="nf">unique_records</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">,</span> <span class="s1">&#39;fasta&#39;</span><span class="p">):</span>  
                <span class="k">if</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">seq</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_seqs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_ids</span><span class="p">):</span>
                    <span class="n">seen_seqs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
                    <span class="n">seen_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">record</span>
        <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">unique_records</span><span class="p">(),</span> <span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;fasta&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrappers</span><span class="o">.</span><span class="n">runSeqKitNoDup</span><span class="p">(</span><span class="n">input_fasta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="p">,</span> <span class="n">output_fasta</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                <span class="n">export_duplicates</span><span class="o">=</span><span class="n">export_duplicates</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">point_to_new_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFilePath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.setFilePath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setFilePath</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set new path to fasta file</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>new_path</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to fasta file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">setFilePath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Set new path to fasta file</span>

<span class="sd">    Args:</span>
<span class="sd">        new_path (Path): path to fasta file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.FASTA.splitByContigs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">splitByContigs</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Split large fasta file into several ones containing one contig each.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p><em>description</em>. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">splitByContigs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Split large fasta file into several ones containing one contig each.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_dir (Path, optional): _description_. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;split_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">contigs</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file_str</span><span class="p">,</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">contig_name</span><span class="p">,</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">contigs</span><span class="p">:</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">contig_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_file</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">contig_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seq</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.preprocessing.GeneAnnotator" class="doc doc-heading">
        <code>GeneAnnotator</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Run prodigal on assembly, predict ORFs and extract location info</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GeneAnnotator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Run prodigal on assembly, predict ORFs and extract location info</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assembly_file</span><span class="p">:</span> <span class="n">FASTA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize GeneAnnotator</span>

<span class="sd">        Args:</span>
<span class="sd">            assembly_file (FASTA): path to fasta containing assembled nucleotide sequences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assembly_file</span> <span class="o">=</span> <span class="n">assembly_file</span>

    <span class="k">def</span> <span class="nf">annotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">metagenome</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">prodigal_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Run prodigal on assembly and export single fasta file with peptide ORFs predictions</span>

<span class="sd">        Args:</span>
<span class="sd">            processes (int, optional): maximum number of threads. Defaults to all minus one.</span>
<span class="sd">            metagenome (bool, optional): whether assembled sequences correspond to metagenomic data. Defaults to True.</span>
<span class="sd">            output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">            prodigal_args (str, optional): additional arguments to be passed to prodigal CLI. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">processes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">processes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">contigs_dir</span><span class="p">,</span>\
             <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">prodigal_dir</span><span class="p">,</span>\
             <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp_fasta</span><span class="p">:</span>
            <span class="n">contigs_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">contigs_dir</span><span class="p">)</span>
            <span class="n">prodigal_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prodigal_dir</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running prodigal on assembly data&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_assembly_file</span><span class="o">.</span><span class="n">splitByContigs</span><span class="p">(</span><span class="n">contigs_dir</span><span class="p">)</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">parallelizeOverInputFiles</span><span class="p">(</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">runProdigal</span><span class="p">,</span> 
                <span class="n">input_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">contigs_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()),</span>
                <span class="n">n_processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
                <span class="n">output_dir</span><span class="o">=</span><span class="n">prodigal_dir</span><span class="p">,</span>
                <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;fasta&quot;</span><span class="p">,</span>
                <span class="n">metagenome</span><span class="o">=</span><span class="n">metagenome</span><span class="p">,</span>
                <span class="n">additional_args</span><span class="o">=</span><span class="n">prodigal_args</span>
            <span class="p">)</span>
            <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">mergeFASTAs</span><span class="p">(</span>
                <span class="n">prodigal_dir</span><span class="p">,</span>
                <span class="n">output_file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">temp_fasta</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">fromProdigalOutput</span><span class="p">(</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">temp_fasta</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="n">output_file</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.GeneAnnotator.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">assembly_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize GeneAnnotator</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>assembly_file</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.FASTA" href="#pynteny.preprocessing.FASTA">FASTA</a></code>
          </td>
          <td><p>path to fasta containing assembled nucleotide sequences</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assembly_file</span><span class="p">:</span> <span class="n">FASTA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize GeneAnnotator</span>

<span class="sd">    Args:</span>
<span class="sd">        assembly_file (FASTA): path to fasta containing assembled nucleotide sequences</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_assembly_file</span> <span class="o">=</span> <span class="n">assembly_file</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.GeneAnnotator.annotate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">annotate</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metagenome</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prodigal_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run prodigal on assembly and export single fasta file with peptide ORFs predictions</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads. Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>metagenome</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether assembled sequences correspond to metagenomic data. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prodigal_args</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>additional arguments to be passed to prodigal CLI. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>LabelledFASTA</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.LabelledFASTA" href="#pynteny.preprocessing.LabelledFASTA">LabelledFASTA</a></code>
          </td>
          <td><p>object containing the labelled peptide database.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">annotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">metagenome</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">prodigal_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run prodigal on assembly and export single fasta file with peptide ORFs predictions</span>

<span class="sd">    Args:</span>
<span class="sd">        processes (int, optional): maximum number of threads. Defaults to all minus one.</span>
<span class="sd">        metagenome (bool, optional): whether assembled sequences correspond to metagenomic data. Defaults to True.</span>
<span class="sd">        output_file (Path, optional): path to output fasta file. Defaults to None.</span>
<span class="sd">        prodigal_args (str, optional): additional arguments to be passed to prodigal CLI. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">processes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">processes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">contigs_dir</span><span class="p">,</span>\
         <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">prodigal_dir</span><span class="p">,</span>\
         <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp_fasta</span><span class="p">:</span>
        <span class="n">contigs_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">contigs_dir</span><span class="p">)</span>
        <span class="n">prodigal_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prodigal_dir</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running prodigal on assembly data&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assembly_file</span><span class="o">.</span><span class="n">splitByContigs</span><span class="p">(</span><span class="n">contigs_dir</span><span class="p">)</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">parallelizeOverInputFiles</span><span class="p">(</span>
            <span class="n">wrappers</span><span class="o">.</span><span class="n">runProdigal</span><span class="p">,</span> 
            <span class="n">input_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">contigs_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()),</span>
            <span class="n">n_processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
            <span class="n">output_dir</span><span class="o">=</span><span class="n">prodigal_dir</span><span class="p">,</span>
            <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;fasta&quot;</span><span class="p">,</span>
            <span class="n">metagenome</span><span class="o">=</span><span class="n">metagenome</span><span class="p">,</span>
            <span class="n">additional_args</span><span class="o">=</span><span class="n">prodigal_args</span>
        <span class="p">)</span>
        <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">mergeFASTAs</span><span class="p">(</span>
            <span class="n">prodigal_dir</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">temp_fasta</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">LabelledFASTA</span><span class="o">.</span><span class="n">fromProdigalOutput</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">temp_fasta</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="n">output_file</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.preprocessing.LabelledFASTA" class="doc doc-heading">
        <code>LabelledFASTA</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.FASTA" href="#pynteny.preprocessing.FASTA">FASTA</a></code></p>

  
      <p>Tools to add and parse FASTA with positional info on record tags</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LabelledFASTA</span><span class="p">(</span><span class="n">FASTA</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tools to add and parse FASTA with positional info on record tags</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromProdigalOutput</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                           <span class="n">prodigal_faa</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                           <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Instantiate class from prodigal output file. </span>
<span class="sd">        Extract positional gene info from prodigal output and export to fasta file.</span>

<span class="sd">        Args:</span>
<span class="sd">            prodigal_faa (Path): path to prodigal output file containing peptide sequences</span>
<span class="sd">            output_file (Path, optional): path to output labelled fasta file. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">number_prodigal_record_fields</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_longlabels.fasta&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">name_list</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">number_prodigal_record_fields</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid prodigal header format for record: </span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">contig</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">gene_number</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                <span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;pos&quot;</span> <span class="k">if</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;neg&quot;</span> <span class="k">if</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-1&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">contig</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_number</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">contig</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_number</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">strand</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_seq</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromGenBankData</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                        <span class="n">gbk_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                        <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">nucleotide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Assign gene positional info, such as contig, gene number and loci</span>
<span class="sd">        to each record in genbank database and return LabelledFASTA object.</span>

<span class="sd">        Args:</span>
<span class="sd">            gbk_data (Path): path to file or directory contanining genbank files</span>
<span class="sd">            output_file (Path, optional): path to output labelled fasta file. Defaults to None.</span>
<span class="sd">            prefix (str, optional): prefix for output file. Defaults to None.</span>
<span class="sd">            nucleotide (bool, optional): whether records corresponds to nucleotide sequences instead of peptides. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">gbk_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">gbk_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">gbk_data</span> <span class="o">/</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">gbk_data</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gbk_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">gbk_data</span><span class="p">]</span>
        <span class="n">gbk_contigs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">contig</span> <span class="k">for</span> <span class="n">gbk_file</span> <span class="ow">in</span> <span class="n">gbk_files</span>
            <span class="k">for</span> <span class="n">contig</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">gbk_file</span><span class="p">,</span> <span class="s1">&#39;genbank&#39;</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gbk_files</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">sequence_database.fasta&quot;</span>

        <span class="k">def</span> <span class="nf">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">[</span><span class="s2">&quot;locus_tag&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">strand</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">end</span><span class="p">),</span> <span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">strand</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">strand_sense</span> <span class="o">=</span> <span class="s2">&quot;neg&quot;</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;pos&quot;</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">gbk_contig</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_counter</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">strand_sense</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">nucleotide</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">):</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">)</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sequence</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">gene_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">gene_counter</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;translation&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">:</span>
                    <span class="n">header</span> <span class="o">=</span> <span class="n">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
                    <span class="n">sequence</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">[</span><span class="s2">&quot;translation&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sequence</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">gene_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">gene_counter</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">gbk_contig</span> <span class="ow">in</span> <span class="n">gbk_contigs</span><span class="p">:</span>
                <span class="n">gene_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">gbk_contig</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;cds&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="n">gene_counter</span> <span class="o">=</span> <span class="n">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.LabelledFASTA.fromGenBankData" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fromGenBankData</span><span class="p">(</span><span class="n">gbk_data</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nucleotide</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Assign gene positional info, such as contig, gene number and loci
to each record in genbank database and return LabelledFASTA object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gbk_data</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to file or directory contanining genbank files</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output labelled fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>prefix for output file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>nucleotide</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether records corresponds to nucleotide sequences instead of peptides. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>LabelledFASTA</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.LabelledFASTA" href="#pynteny.preprocessing.LabelledFASTA">LabelledFASTA</a></code>
          </td>
          <td><p>object containing the labelled peptide database.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromGenBankData</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                    <span class="n">gbk_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">nucleotide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Assign gene positional info, such as contig, gene number and loci</span>
<span class="sd">    to each record in genbank database and return LabelledFASTA object.</span>

<span class="sd">    Args:</span>
<span class="sd">        gbk_data (Path): path to file or directory contanining genbank files</span>
<span class="sd">        output_file (Path, optional): path to output labelled fasta file. Defaults to None.</span>
<span class="sd">        prefix (str, optional): prefix for output file. Defaults to None.</span>
<span class="sd">        nucleotide (bool, optional): whether records corresponds to nucleotide sequences instead of peptides. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gbk_data</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">gbk_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">gbk_data</span> <span class="o">/</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">gbk_data</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gbk_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">gbk_data</span><span class="p">]</span>
    <span class="n">gbk_contigs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">contig</span> <span class="k">for</span> <span class="n">gbk_file</span> <span class="ow">in</span> <span class="n">gbk_files</span>
        <span class="k">for</span> <span class="n">contig</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">gbk_file</span><span class="p">,</span> <span class="s1">&#39;genbank&#39;</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gbk_files</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">sequence_database.fasta&quot;</span>

    <span class="k">def</span> <span class="nf">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">[</span><span class="s2">&quot;locus_tag&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">strand</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">end</span><span class="p">),</span> <span class="n">feature</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">strand</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">strand_sense</span> <span class="o">=</span> <span class="s2">&quot;neg&quot;</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;pos&quot;</span> <span class="k">if</span> <span class="n">strand</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">gbk_contig</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_counter</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">strand_sense</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">nucleotide</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">):</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
            <span class="n">sequence</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">)</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sequence</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gene_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">gene_counter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;translation&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">:</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">get_label_str</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">[</span><span class="s2">&quot;translation&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sequence</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">gene_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">gene_counter</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">gbk_contig</span> <span class="ow">in</span> <span class="n">gbk_contigs</span><span class="p">:</span>
            <span class="n">gene_counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">gbk_contig</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;cds&quot;</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">gene_counter</span> <span class="o">=</span> <span class="n">write_record</span><span class="p">(</span><span class="n">gbk_contig</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">gene_counter</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.LabelledFASTA.fromProdigalOutput" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fromProdigalOutput</span><span class="p">(</span><span class="n">prodigal_faa</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Instantiate class from prodigal output file. 
Extract positional gene info from prodigal output and export to fasta file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>prodigal_faa</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to prodigal output file containing peptide sequences</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output labelled fasta file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>LabelledFASTA</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.preprocessing.LabelledFASTA" href="#pynteny.preprocessing.LabelledFASTA">LabelledFASTA</a></code>
          </td>
          <td><p>object containing the labelled peptide database.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromProdigalOutput</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                       <span class="n">prodigal_faa</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                       <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LabelledFASTA</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Instantiate class from prodigal output file. </span>
<span class="sd">    Extract positional gene info from prodigal output and export to fasta file.</span>

<span class="sd">    Args:</span>
<span class="sd">        prodigal_faa (Path): path to prodigal output file containing peptide sequences</span>
<span class="sd">        output_file (Path, optional): path to output labelled fasta file. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LabelledFASTA: object containing the labelled peptide database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">number_prodigal_record_fields</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_longlabels.fasta&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pyfastx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="n">prodigal_faa</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">build_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">full_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">record_name</span><span class="p">,</span> <span class="n">record_seq</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">name_list</span> <span class="o">=</span> <span class="n">record_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">number_prodigal_record_fields</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid prodigal header format for record: </span><span class="si">{</span><span class="n">record_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">contig</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">gene_number</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;pos&quot;</span> <span class="k">if</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;neg&quot;</span> <span class="k">if</span> <span class="n">name_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-1&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&gt;</span><span class="si">{</span><span class="n">contig</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_number</span><span class="si">}</span><span class="s2">__</span><span class="si">{</span><span class="n">contig</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">gene_number</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">strand</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_seq</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.preprocessing.RecordSequence" class="doc doc-heading">
        <code>RecordSequence</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Tools to process nucleotide or peptide sequences</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RecordSequence</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Tools to process nucleotide or peptide sequences</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">removeStopCodonSignals</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove stop codon signals from peptide sequence</span>

<span class="sd">        Args:</span>
<span class="sd">            record_seq (str): peptide sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: a peptide sequence without stop codon symbols.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">record_seq</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">isLegitPeptideSequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Assert that peptide sequence only contains valid symbols.</span>

<span class="sd">        Args:</span>
<span class="sd">            record_seq (str): peptide sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: whether peptide sequence only contains legit symbols.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aas</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span>
            <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span>
        <span class="p">}</span>
        <span class="n">seq_symbols</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">record_seq</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">seq_symbols</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">aas</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">isLegitDNAsequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Assert that DNA sequence only contains valid symbols.</span>

<span class="sd">        Args:</span>
<span class="sd">            record_seq (str): nucleotide sequence.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: whether nucleotide sequence only contains legit symbols.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">}</span>
        <span class="n">seq_symbols</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">record_seq</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">seq_symbols</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.RecordSequence.isLegitDNAsequence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isLegitDNAsequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Assert that DNA sequence only contains valid symbols.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>record_seq</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>nucleotide sequence.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td><p>whether nucleotide sequence only contains legit symbols.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">isLegitDNAsequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Assert that DNA sequence only contains valid symbols.</span>

<span class="sd">    Args:</span>
<span class="sd">        record_seq (str): nucleotide sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: whether nucleotide sequence only contains legit symbols.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">}</span>
    <span class="n">seq_symbols</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">record_seq</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">seq_symbols</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">nts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.RecordSequence.isLegitPeptideSequence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isLegitPeptideSequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Assert that peptide sequence only contains valid symbols.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>record_seq</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>peptide sequence.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td><p>whether peptide sequence only contains legit symbols.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">isLegitPeptideSequence</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Assert that peptide sequence only contains valid symbols.</span>

<span class="sd">    Args:</span>
<span class="sd">        record_seq (str): peptide sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: whether peptide sequence only contains legit symbols.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aas</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span>
        <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span>
    <span class="p">}</span>
    <span class="n">seq_symbols</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">record_seq</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">seq_symbols</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">aas</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.preprocessing.RecordSequence.removeStopCodonSignals" class="doc doc-heading">
<code class="highlight language-python"><span class="n">removeStopCodonSignals</span><span class="p">(</span><span class="n">record_seq</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove stop codon signals from peptide sequence</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>record_seq</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>peptide sequence.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>a peptide sequence without stop codon symbols.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/preprocessing.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">removeStopCodonSignals</span><span class="p">(</span><span class="n">record_seq</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Remove stop codon signals from peptide sequence</span>

<span class="sd">    Args:</span>
<span class="sd">        record_seq (str): peptide sequence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: a peptide sequence without stop codon symbols.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">record_seq</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="module-hmm">Module hmm</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.hmm"></a>
  <div class="doc doc-contents first">
  
      <p>Tools to parse Hmmer output and PGAP (HMM) database</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.hmm.HMMER" class="doc doc-heading">
        <code>HMMER</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Run Hmmer on multiple hmms and parse output</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/hmm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HMMER</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run Hmmer on multiple hmms and parse output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_hmms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span>
                 <span class="n">hmm_output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                 <span class="n">input_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                 <span class="n">additional_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize class HMMER</span>

<span class="sd">        Args:</span>
<span class="sd">            input_hmms (list[Path]): list of paths to input HMM files.</span>
<span class="sd">            hmm_output_dir (Path): path to output directory to HMMER output files.</span>
<span class="sd">            input_data (Path): path to input fasta file with sequence database.</span>
<span class="sd">            additional_args (list[str]): additional arguments to hmmsearch or hmmscan. Each</span>
<span class="sd">                element in the list is a string with additional arguments for each </span>
<span class="sd">                input hmm (arranged in the same order), an element can also take a </span>
<span class="sd">                value of None to avoid passing additional arguments for a specific </span>
<span class="sd">                input hmm. A single string may also be passed, in which case the </span>
<span class="sd">                same additional argument is passed to hmmsearch for all input hmms. </span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            processes (int, optional): maximum number of threads to be employed.</span>
<span class="sd">                Defaults to all minus one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hmmer_output_dir</span> <span class="o">=</span> <span class="n">hmm_output_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_hmms</span> <span class="o">=</span> <span class="n">input_hmms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_fasta</span> <span class="o">=</span> <span class="n">input_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_additional_args</span> <span class="o">=</span> <span class="n">additional_args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="n">processes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hmm_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get file names of input HMMs</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: list of file names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">hmm_path</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">hmm_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_hmms</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parseHMMsearchOutput</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parse hmmsearch or hmmscan summary table output file.</span>

<span class="sd">        Args:</span>
<span class="sd">            hmmer_output (str): path to HMMER output file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: a dataframe containing parsed HMMER output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attribs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;bitscore&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]</span>
        <span class="n">hits</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">queryresult</span> <span class="ow">in</span> <span class="n">SearchIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s1">&#39;hmmer3-tab&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">queryresult</span><span class="o">.</span><span class="n">hits</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
                        <span class="n">hits</span><span class="p">[</span><span class="n">attrib</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">hit</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getHMMERtables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">reuse_hmmer_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                       <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hmmsearch&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Run hmmer for given hmm list</span>

<span class="sd">        Args:</span>
<span class="sd">            reuse_hmmer_results (bool, optional): if True then HMMER3 won&#39;t be run</span>
<span class="sd">            again for HMMs already searched in the same output directory. Defaults to True.</span>
<span class="sd">            method (str, optional): select between &#39;hmmsearch&#39; or &#39;hmmscan&#39;.</span>
<span class="sd">            Defaults to &#39;hmmsearch&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[pd.DataFrame]: dict of HMMER hits as pandas dataframes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hmm_hits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">hmm_model</span><span class="p">,</span> <span class="n">add_args</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_hmms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_args</span><span class="p">):</span>
            <span class="n">hmm_name</span> <span class="o">=</span> <span class="n">hmm_model</span><span class="o">.</span><span class="n">stem</span>
            <span class="n">hmmer_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hmmer_output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;hmmer_output_</span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">reuse_hmmer_results</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">runHMMsearch</span><span class="p">(</span>
                    <span class="n">hmm_model</span><span class="o">=</span><span class="n">hmm_model</span><span class="p">,</span>
                    <span class="n">input_fasta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_fasta</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="o">=</span><span class="n">hmmer_output</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                    <span class="n">n_processes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">,</span>
                    <span class="n">additional_args</span><span class="o">=</span><span class="n">add_args</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">reuse_hmmer_results</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reusing Hmmer results for HMM: </span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">hmm_hits</span><span class="p">[</span><span class="n">hmm_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">HMMER</span><span class="o">.</span><span class="n">parseHMMsearchOutput</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hmm_hits</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="pynteny.hmm.HMMER.hmm_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hmm_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get file names of input HMMs</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>list[str]: list of file names.</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.HMMER.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_hmms</span><span class="p">,</span> <span class="n">hmm_output_dir</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">additional_args</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize class HMMER</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_hmms</code></td>
          <td>
                <code>list[<span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>list of paths to input HMM files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hmm_output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output directory to HMMER output files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input fasta file with sequence database.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>additional_args</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>additional arguments to hmmsearch or hmmscan. Each
element in the list is a string with additional arguments for each 
input hmm (arranged in the same order), an element can also take a 
value of None to avoid passing additional arguments for a specific 
input hmm. A single string may also be passed, in which case the 
same additional argument is passed to hmmsearch for all input hmms. 
Defaults to None.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads to be employed.
Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_hmms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span>
             <span class="n">hmm_output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
             <span class="n">input_data</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
             <span class="n">additional_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
             <span class="n">processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize class HMMER</span>

<span class="sd">    Args:</span>
<span class="sd">        input_hmms (list[Path]): list of paths to input HMM files.</span>
<span class="sd">        hmm_output_dir (Path): path to output directory to HMMER output files.</span>
<span class="sd">        input_data (Path): path to input fasta file with sequence database.</span>
<span class="sd">        additional_args (list[str]): additional arguments to hmmsearch or hmmscan. Each</span>
<span class="sd">            element in the list is a string with additional arguments for each </span>
<span class="sd">            input hmm (arranged in the same order), an element can also take a </span>
<span class="sd">            value of None to avoid passing additional arguments for a specific </span>
<span class="sd">            input hmm. A single string may also be passed, in which case the </span>
<span class="sd">            same additional argument is passed to hmmsearch for all input hmms. </span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        processes (int, optional): maximum number of threads to be employed.</span>
<span class="sd">            Defaults to all minus one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hmmer_output_dir</span> <span class="o">=</span> <span class="n">hmm_output_dir</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_hmms</span> <span class="o">=</span> <span class="n">input_hmms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_fasta</span> <span class="o">=</span> <span class="n">input_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_additional_args</span> <span class="o">=</span> <span class="n">additional_args</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="n">processes</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.HMMER.getHMMERtables" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHMMERtables</span><span class="p">(</span><span class="n">reuse_hmmer_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hmmsearch&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run hmmer for given hmm list</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>reuse_hmmer_results</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if True then HMMER3 won't be run</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>select between 'hmmsearch' or 'hmmscan'.</p></td>
          <td>
                <code>&#39;hmmsearch&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict[<span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td><p>dict[pd.DataFrame]: dict of HMMER hits as pandas dataframes.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getHMMERtables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">reuse_hmmer_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hmmsearch&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Run hmmer for given hmm list</span>

<span class="sd">    Args:</span>
<span class="sd">        reuse_hmmer_results (bool, optional): if True then HMMER3 won&#39;t be run</span>
<span class="sd">        again for HMMs already searched in the same output directory. Defaults to True.</span>
<span class="sd">        method (str, optional): select between &#39;hmmsearch&#39; or &#39;hmmscan&#39;.</span>
<span class="sd">        Defaults to &#39;hmmsearch&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[pd.DataFrame]: dict of HMMER hits as pandas dataframes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hmm_hits</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">hmm_model</span><span class="p">,</span> <span class="n">add_args</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_hmms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additional_args</span><span class="p">):</span>
        <span class="n">hmm_name</span> <span class="o">=</span> <span class="n">hmm_model</span><span class="o">.</span><span class="n">stem</span>
        <span class="n">hmmer_output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hmmer_output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;hmmer_output_</span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">reuse_hmmer_results</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)):</span>
            <span class="n">wrappers</span><span class="o">.</span><span class="n">runHMMsearch</span><span class="p">(</span>
                <span class="n">hmm_model</span><span class="o">=</span><span class="n">hmm_model</span><span class="p">,</span>
                <span class="n">input_fasta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_fasta</span><span class="p">,</span>
                <span class="n">output_file</span><span class="o">=</span><span class="n">hmmer_output</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">n_processes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">,</span>
                <span class="n">additional_args</span><span class="o">=</span><span class="n">add_args</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">reuse_hmmer_results</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reusing Hmmer results for HMM: </span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">hmm_hits</span><span class="p">[</span><span class="n">hmm_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">HMMER</span><span class="o">.</span><span class="n">parseHMMsearchOutput</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hmm_hits</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.HMMER.parseHMMsearchOutput" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parseHMMsearchOutput</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse hmmsearch or hmmscan summary table output file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmmer_output</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>path to HMMER output file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: a dataframe containing parsed HMMER output.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parseHMMsearchOutput</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parse hmmsearch or hmmscan summary table output file.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmmer_output (str): path to HMMER output file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: a dataframe containing parsed HMMER output.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attribs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;bias&#39;</span><span class="p">,</span> <span class="s1">&#39;bitscore&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]</span>
    <span class="n">hits</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">hmmer_output</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">queryresult</span> <span class="ow">in</span> <span class="n">SearchIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s1">&#39;hmmer3-tab&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">queryresult</span><span class="o">.</span><span class="n">hits</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
                    <span class="n">hits</span><span class="p">[</span><span class="n">attrib</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">hit</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">hits</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.hmm.PGAP" class="doc doc-heading">
        <code>PGAP</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Tools to parse PGAP hmm database metadata</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/hmm.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PGAP</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Tools to parse PGAP hmm database metadata</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize class PGAP</span>

<span class="sd">        Args:</span>
<span class="sd">            meta_file (Path): path to PGAP&#39;s metadata file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">meta_file</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;ec_numbers&quot;</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span> <span class="o">=</span> <span class="n">meta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta_file</span> <span class="o">=</span> <span class="n">meta_file</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extractPGAPtoDirectory</span><span class="p">(</span><span class="n">pgap_tar</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Extract PGAP hmm database (tar.gz) to given directory</span>

<span class="sd">        Args:</span>
<span class="sd">            pgap_tar (Path): path to compressed PGAP database.</span>
<span class="sd">            output_dir (Path): path to output directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isTarFile</span><span class="p">(</span><span class="n">pgap_tar</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pgap_tar</span><span class="si">}</span><span class="s2"> is not a tar file. Skipping extraction&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting hmm files to target directory&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
        <span class="n">extractTarFile</span><span class="p">(</span>
            <span class="n">tar_file</span><span class="o">=</span><span class="n">pgap_tar</span><span class="p">,</span>
            <span class="n">dest_dir</span><span class="o">=</span><span class="n">output_dir</span>
        <span class="p">)</span>
        <span class="n">flattenDirectory</span><span class="p">(</span>
            <span class="n">output_dir</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeMissingHMMsFromMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                                      <span class="n">outfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove HMMs from metadata that are not in HMM directory</span>

<span class="sd">        Args:</span>
<span class="sd">            hmm_dir (Path): path to directory containing PGAP database.</span>
<span class="sd">            outfile (Path, optional): path to output file. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_missing_hmms.tsv&quot;</span>
        <span class="k">if</span> <span class="n">isTarFile</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">):</span>
            <span class="n">hmm_file_names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">hmm_file</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">hmm_file</span> <span class="ow">in</span> <span class="n">listTarDir</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">)</span>
                <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hmm_file_names</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">hmm_file</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">hmm_file</span> <span class="ow">in</span> <span class="n">hmm_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
                <span class="p">]</span>
        <span class="n">not_found</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> 
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hmm_file_names</span><span class="p">:</span>
                <span class="n">not_found</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getHMMnamesByGeneSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Try to retrieve HMM by its gene symbol, more</span>
<span class="sd">           than one HMM may map to a single gene symbol</span>

<span class="sd">        Args:</span>
<span class="sd">            gene_symbol (str): gene symbol to be searched for HMM.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: list of HMM names matching gene symbol.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="c1">#.dropna(subset=[&quot;gene_symbol&quot;, &quot;label&quot;], axis=0)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">meta</span><span class="p">[</span>
                <span class="p">(</span>
                    <span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">gene_symbol</span> <span class="o">==</span> <span class="n">gene_symbol</span><span class="p">)</span> <span class="o">|</span>
                    <span class="c1"># (meta.label.str.contains(gene_id))</span>
                    <span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">gene_symbol</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">][</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getHMMgroupForGeneSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get HMMs corresponding to gene symbol in PGAP metadata.</span>
<span class="sd">           If more than one HMM matching gene symbol, return a HMM group</span>

<span class="sd">        Args:</span>
<span class="sd">            gene_symbol (str): gene symbol to be searched for HMM.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: string of HMM names (group separated by |)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hmms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHMMnamesByGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hmms</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No HMM found for gene </span><span class="si">{</span><span class="n">gene_symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hmms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hmms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hmms</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getHMMgeneID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> 
        <span class="sd">&quot;&quot;&quot;Get gene symbols matching given hmm.</span>

<span class="sd">        Args:</span>
<span class="sd">            hmm_name (str): query HMM name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: list of gene symbols matching given HMM.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">meta</span><span class="p">[</span>
                <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hmm_name</span>
            <span class="p">][</span><span class="s2">&quot;gene_symbol&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">getMetaInfoForHMM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get meta info for given hmm.</span>

<span class="sd">        Args:</span>
<span class="sd">            hmm_name (str): query HMM name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: metadata of provided HMM.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;undef&quot;</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hmm_name</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No metadata for HMM: </span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">meta_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize class PGAP</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>meta_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to PGAP's metadata file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meta_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize class PGAP</span>

<span class="sd">    Args:</span>
<span class="sd">        meta_file (Path): path to PGAP&#39;s metadata file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">meta_file</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;product_name&quot;</span><span class="p">,</span> <span class="s2">&quot;ec_numbers&quot;</span><span class="p">]]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span> <span class="o">=</span> <span class="n">meta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta_file</span> <span class="o">=</span> <span class="n">meta_file</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.extractPGAPtoDirectory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extractPGAPtoDirectory</span><span class="p">(</span><span class="n">pgap_tar</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Extract PGAP hmm database (tar.gz) to given directory</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pgap_tar</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to compressed PGAP database.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output directory.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">extractPGAPtoDirectory</span><span class="p">(</span><span class="n">pgap_tar</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Extract PGAP hmm database (tar.gz) to given directory</span>

<span class="sd">    Args:</span>
<span class="sd">        pgap_tar (Path): path to compressed PGAP database.</span>
<span class="sd">        output_dir (Path): path to output directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isTarFile</span><span class="p">(</span><span class="n">pgap_tar</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pgap_tar</span><span class="si">}</span><span class="s2"> is not a tar file. Skipping extraction&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting hmm files to target directory&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">output_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
    <span class="n">extractTarFile</span><span class="p">(</span>
        <span class="n">tar_file</span><span class="o">=</span><span class="n">pgap_tar</span><span class="p">,</span>
        <span class="n">dest_dir</span><span class="o">=</span><span class="n">output_dir</span>
    <span class="p">)</span>
    <span class="n">flattenDirectory</span><span class="p">(</span>
        <span class="n">output_dir</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.getHMMgeneID" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHMMgeneID</span><span class="p">(</span><span class="n">hmm_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get gene symbols matching given hmm.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>query HMM name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>list[str]: list of gene symbols matching given HMM.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getHMMgeneID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> 
    <span class="sd">&quot;&quot;&quot;Get gene symbols matching given hmm.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_name (str): query HMM name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: list of gene symbols matching given HMM.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">meta</span><span class="p">[</span>
            <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hmm_name</span>
        <span class="p">][</span><span class="s2">&quot;gene_symbol&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.getHMMgroupForGeneSymbol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHMMgroupForGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get HMMs corresponding to gene symbol in PGAP metadata.
   If more than one HMM matching gene symbol, return a HMM group</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gene_symbol</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>gene symbol to be searched for HMM.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>string of HMM names (group separated by |)</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getHMMgroupForGeneSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get HMMs corresponding to gene symbol in PGAP metadata.</span>
<span class="sd">       If more than one HMM matching gene symbol, return a HMM group</span>

<span class="sd">    Args:</span>
<span class="sd">        gene_symbol (str): gene symbol to be searched for HMM.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: string of HMM names (group separated by |)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hmms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHMMnamesByGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">hmms</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No HMM found for gene </span><span class="si">{</span><span class="n">gene_symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hmms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hmms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hmms</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.getHMMnamesByGeneSymbol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHMMnamesByGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Try to retrieve HMM by its gene symbol, more
   than one HMM may map to a single gene symbol</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>gene_symbol</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>gene symbol to be searched for HMM.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>list[str]: list of HMM names matching gene symbol.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getHMMnamesByGeneSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gene_symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Try to retrieve HMM by its gene symbol, more</span>
<span class="sd">       than one HMM may map to a single gene symbol</span>

<span class="sd">    Args:</span>
<span class="sd">        gene_symbol (str): gene symbol to be searched for HMM.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: list of HMM names matching gene symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="c1">#.dropna(subset=[&quot;gene_symbol&quot;, &quot;label&quot;], axis=0)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">meta</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">gene_symbol</span> <span class="o">==</span> <span class="n">gene_symbol</span><span class="p">)</span> <span class="o">|</span>
                <span class="c1"># (meta.label.str.contains(gene_id))</span>
                <span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">gene_symbol</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">][</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.getMetaInfoForHMM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getMetaInfoForHMM</span><span class="p">(</span><span class="n">hmm_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get meta info for given hmm.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>query HMM name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>metadata of provided HMM.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getMetaInfoForHMM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get meta info for given hmm.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_name (str): query HMM name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: metadata of provided HMM.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;undef&quot;</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">[</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hmm_name</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No metadata for HMM: </span><span class="si">{</span><span class="n">hmm_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.hmm.PGAP.removeMissingHMMsFromMetadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">removeMissingHMMsFromMetadata</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove HMMs from metadata that are not in HMM directory</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to directory containing PGAP database.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>outfile</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/hmm.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">removeMissingHMMsFromMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hmm_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                                  <span class="n">outfile</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Remove HMMs from metadata that are not in HMM directory</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_dir (Path): path to directory containing PGAP database.</span>
<span class="sd">        outfile (Path, optional): path to output file. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_missing_hmms.tsv&quot;</span>
    <span class="k">if</span> <span class="n">isTarFile</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">):</span>
        <span class="n">hmm_file_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">hmm_file</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">hmm_file</span> <span class="ow">in</span> <span class="n">listTarDir</span><span class="p">(</span><span class="n">hmm_dir</span><span class="p">)</span>
            <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hmm_file_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">hmm_file</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">hmm_file</span> <span class="ow">in</span> <span class="n">hmm_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
            <span class="p">]</span>
    <span class="n">not_found</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> 
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;#ncbi_accession&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hmm_file_names</span><span class="p">:</span>
            <span class="n">not_found</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">not_found</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="module-parser">Module parser</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.parser"></a>
  <div class="doc doc-contents first">
  
      <p>Tools to parse synteny structure</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.parser.LabelParser" class="doc doc-heading">
        <code>LabelParser</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Parse entry label to extract coded info</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/parser.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LabelParser</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Parse entry label to extract coded info</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parse sequence labels to obtain contig and locus info</span>

<span class="sd">        Args:</span>
<span class="sd">            label (str): sequence label</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: dictionary with parsed label info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;full_label&quot;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span>
            <span class="s2">&quot;gene_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;contig&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gene_pos&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;locus_pos&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;strand&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">}</span> 
        <span class="k">try</span><span class="p">:</span> 
            <span class="n">entry</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">locus_pos</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">gene_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">contig</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>

            <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;contig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">contig</span>
            <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;gene_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_pos</span> 
            <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;locus_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">locus_pos</span>
            <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strand</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">parsed_dict</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_from_list</span><span class="p">(</span><span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span> 
        <span class="sd">&quot;&quot;&quot;Parse labels in list of labels and return DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels (list, optional): list of labels as stringgs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Dataframe containing parsed information from labels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">[</span><span class="n">LabelParser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.LabelParser.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse sequence labels to obtain contig and locus info</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>label</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>sequence label</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>dictionary with parsed label info.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parse sequence labels to obtain contig and locus info</span>

<span class="sd">    Args:</span>
<span class="sd">        label (str): sequence label</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: dictionary with parsed label info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;full_label&quot;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span>
        <span class="s2">&quot;gene_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contig&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gene_pos&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;locus_pos&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;strand&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}</span> 
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">entry</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">strand</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">locus_pos</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">gene_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">contig</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>

        <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
        <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;contig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">contig</span>
        <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;gene_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene_pos</span> 
        <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;locus_pos&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">locus_pos</span>
        <span class="n">parsed_dict</span><span class="p">[</span><span class="s2">&quot;strand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strand</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">parsed_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.LabelParser.parse_from_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_from_list</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse labels in list of labels and return DataFrame.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list of labels as stringgs.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td><p>pd.DataFrame: Dataframe containing parsed information from labels.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse_from_list</span><span class="p">(</span><span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;Parse labels in list of labels and return DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels (list, optional): list of labels as stringgs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Dataframe containing parsed information from labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">[</span><span class="n">LabelParser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.parser.SyntenyParser" class="doc doc-heading">
        <code>SyntenyParser</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Tools to parse synteny structure strings</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/parser.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SyntenyParser</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Tools to parse synteny structure strings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">reformatSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove illegal symbols and extra white space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">&quot; |&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;| &quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">synteny_structure</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">containsHMMgroups</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Check whether structure contains groups of gene-equivalent HMMs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;|&quot;</span> <span class="ow">in</span> <span class="n">synteny_structure</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">isValidStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Validate synteny structure format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">&quot; |&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;| &quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">parsed_struc</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="n">right_type</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
            <span class="p">(</span><span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
            <span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
            <span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">right_format</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">])</span> <span class="ow">and</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">right_type</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">right_format</span><span class="p">)</span> <span class="k">else</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">splitStrandFromLocus</span><span class="p">(</span><span class="n">locus_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                             <span class="n">parsed_symbol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Split strand info from locus tag / HMM model.</span>

<span class="sd">        Args:</span>
<span class="sd">            locus_str (str): a substring of a synteny structure containing </span>
<span class="sd">                a gene symbol / HMM name and strand info.</span>
<span class="sd">            parsed_symbol (bool, optional): if True, strand info &#39;&gt;&#39; is parsed </span>
<span class="sd">                as &#39;pos&#39; and &#39;&lt;&#39; as &#39;neg&#39;. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str]: tuple with parsed strand info and gene symbol / HMM name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">locus_str</span> <span class="o">=</span> <span class="n">locus_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">or</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
            <span class="n">sense</span> <span class="o">=</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">locus_str</span> <span class="o">=</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">parsed_symbol</span><span class="p">:</span>
                <span class="n">strand</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span> <span class="k">if</span> <span class="n">sense</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="k">else</span> <span class="s1">&#39;neg&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">strand</span> <span class="o">=</span> <span class="n">sense</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">strand</span><span class="p">,</span> <span class="n">locus_str</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get hmm names employed in synteny structure,</span>
<span class="sd">        if more than one hmm for the same gene, return</span>
<span class="sd">        a list with all of them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hmm_groups</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="n">hmm_groups</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getGeneSymbolsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Retrieve gene symbols contained in synteny structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gene_symbols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="n">gene_symbols</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getAllHMMsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get hmm names employed in synteny structure,</span>
<span class="sd">        if more than one hmm for the same gene, return</span>
<span class="sd">        a list with all of them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="n">hmm_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">hmm</span> <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span> <span class="k">for</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="n">hmm_group</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">hmm_names</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getStrandsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                              <span class="n">parsed_symbol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get strand sense list in structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            synteny_structure (str): a synteny structure.</span>
<span class="sd">            parsed_symbol (bool, optional): if True, strand info &#39;&gt;&#39; is parsed </span>
<span class="sd">                as &#39;pos&#39; and &#39;&lt;&#39; as &#39;neg&#39;. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: parsed synteny structure as a list of tuples containing</span>
<span class="sd">                HMM name and strand info for each HMM group.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> 
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
            <span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getMaximumDistancesInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get maximum gene distances in synteny structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; Parse synteny structure string.</span>

<span class="sd">        Args:</span>
<span class="sd">            synteny_structure (str): a string like the following:</span>
<span class="sd">                &gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c</span>

<span class="sd">                where &#39;&gt;&#39; indicates a hmm target located on the positive strand,</span>
<span class="sd">                &#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span>
<span class="sd">                to the maximum number of genes separating matched gene a and b. </span>
<span class="sd">                Multiple hmms may be employed (limited by computational capabilities).</span>
<span class="sd">                No order symbol in a hmm indicates that results should be independent</span>
<span class="sd">                of strand location.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: parsed synteny structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">max_dists</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getMaximumDistancesInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="n">hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="n">strands</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getStrandsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">:</span> <span class="n">hmm_groups</span><span class="p">,</span> <span class="s2">&quot;strands&quot;</span><span class="p">:</span> <span class="n">strands</span><span class="p">,</span> <span class="s2">&quot;distances&quot;</span><span class="p">:</span> <span class="n">max_dists</span><span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parseGenesInSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">dict</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Convert gene-based synteny structure into a HMM-based one.</span>
<span class="sd">        If a gene symbol matches more than one HMM, return a HMM group</span>
<span class="sd">        like: (HMM1 | HMM2 | ...).</span>

<span class="sd">        Args:</span>
<span class="sd">            synteny_structure (str): a string like the following:</span>
<span class="sd">                &gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c</span>

<span class="sd">                where &#39;&gt;&#39; indicates a hmm target located on the positive strand,</span>
<span class="sd">                &#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span>
<span class="sd">                to the maximum number of genes separating matched gene a and b. </span>
<span class="sd">                Multiple hmms may be employed (limited by computational capabilities).</span>
<span class="sd">                No order symbol in a hmm indicates that results should be independent</span>
<span class="sd">                of strand location.</span>
<span class="sd">            hmm_meta (Path): path to PGAP&#39;s metadata file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[str,dict]: parsed synteny structure where gene symbols are replaced</span>
<span class="sd">                by HMM names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pgap</span> <span class="o">=</span> <span class="n">PGAP</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span>
        <span class="n">gene_symbols</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getGeneSymbolsInStructure</span><span class="p">(</span>
            <span class="n">synteny_structure</span>
            <span class="p">)</span>
        <span class="n">strand_locs</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getStrandsInStructure</span><span class="p">(</span>
            <span class="n">synteny_structure</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="n">gene_dists</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getMaximumDistancesInStructure</span><span class="p">(</span>
            <span class="n">synteny_structure</span>
            <span class="p">)</span>
        <span class="n">hmm_groups</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">gene_symbol</span><span class="p">:</span> <span class="n">pgap</span><span class="o">.</span><span class="n">getHMMgroupForGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">gene_symbol</span> <span class="ow">in</span> <span class="n">gene_symbols</span>
        <span class="p">}</span>
        <span class="n">unmatched_genes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">gene_id</span> <span class="k">for</span> <span class="n">gene_id</span><span class="p">,</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">hmm_group</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">unmatched_genes</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;These genes did not get a HMM match in database: </span><span class="si">{</span><span class="n">unmatched_genes</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">hmm_synteny_struc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">strand</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">strand_locs</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">gene_dists</span><span class="p">,</span> <span class="n">hmm_groups</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;|&quot;</span> <span class="ow">in</span> <span class="n">hmm_group</span><span class="p">:</span>
                <span class="n">hmm_group</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="n">hmm_synteny_struc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">strand</span><span class="si">}{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2"> &quot;</span>

        <span class="k">return</span> <span class="n">hmm_synteny_struc</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">hmm_groups</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.containsHMMgroups" class="doc doc-heading">
<code class="highlight language-python"><span class="n">containsHMMgroups</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check whether structure contains groups of gene-equivalent HMMs.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">containsHMMgroups</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check whether structure contains groups of gene-equivalent HMMs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;|&quot;</span> <span class="ow">in</span> <span class="n">synteny_structure</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.getAllHMMsInStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getAllHMMsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get hmm names employed in synteny structure,
if more than one hmm for the same gene, return
a list with all of them.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getAllHMMsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get hmm names employed in synteny structure,</span>
<span class="sd">    if more than one hmm for the same gene, return</span>
<span class="sd">    a list with all of them.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="n">hmm_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">hmm</span> <span class="k">for</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span> <span class="k">for</span> <span class="n">hmm</span> <span class="ow">in</span> <span class="n">hmm_group</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">hmm_names</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.getGeneSymbolsInStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getGeneSymbolsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieve gene symbols contained in synteny structure.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getGeneSymbolsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Retrieve gene symbols contained in synteny structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">gene_symbols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">gene_symbols</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.getHMMgroupsInStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get hmm names employed in synteny structure,
if more than one hmm for the same gene, return
a list with all of them.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get hmm names employed in synteny structure,</span>
<span class="sd">    if more than one hmm for the same gene, return</span>
<span class="sd">    a list with all of them.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">hmm_groups</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">hmm_groups</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.getMaximumDistancesInStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getMaximumDistancesInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get maximum gene distances in synteny structure.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getMaximumDistancesInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get maximum gene distances in synteny structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.getStrandsInStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getStrandsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get strand sense list in structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a synteny structure.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>parsed_symbol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if True, strand info '&gt;' is parsed 
as 'pos' and '&lt;' as 'neg'. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>list[str]: parsed synteny structure as a list of tuples containing
HMM name and strand info for each HMM group.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getStrandsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                          <span class="n">parsed_symbol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get strand sense list in structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_structure (str): a synteny structure.</span>
<span class="sd">        parsed_symbol (bool, optional): if True, strand info &#39;&gt;&#39; is parsed </span>
<span class="sd">            as &#39;pos&#39; and &#39;&lt;&#39; as &#39;neg&#39;. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: parsed synteny structure as a list of tuples containing</span>
<span class="sd">            HMM name and strand info for each HMM group.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid format for synteny structure&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.isValidStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isValidStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Validate synteny structure format.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">isValidStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Validate synteny structure format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">&quot; |&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;| &quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">parsed_struc</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="n">right_type</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">(</span><span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
        <span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">),</span>
        <span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">right_format</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;strands&quot;</span><span class="p">])</span> <span class="ow">and</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parsed_struc</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">right_type</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">right_format</span><span class="p">)</span> <span class="k">else</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.parseGenesInSyntenyStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parseGenesInSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert gene-based synteny structure into a HMM-based one.
If a gene symbol matches more than one HMM, return a HMM group
like: (HMM1 | HMM2 | ...).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a string like the following:</p>
<blockquote>
<p>hmm_a n_ab &lt;hmm_b n_bc hmm_c</p>
</blockquote>
<p>where '&gt;' indicates a hmm target located on the positive strand,
'&lt;' a target located on the negative strand, and n_ab cooresponds 
to the maximum number of genes separating matched gene a and b. 
Multiple hmms may be employed (limited by computational capabilities).
No order symbol in a hmm indicates that results should be independent
of strand location.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hmm_meta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to PGAP's metadata file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str, dict]</code>
          </td>
          <td><p>tuple[str,dict]: parsed synteny structure where gene symbols are replaced
by HMM names.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parseGenesInSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hmm_meta</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">dict</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert gene-based synteny structure into a HMM-based one.</span>
<span class="sd">    If a gene symbol matches more than one HMM, return a HMM group</span>
<span class="sd">    like: (HMM1 | HMM2 | ...).</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_structure (str): a string like the following:</span>
<span class="sd">            &gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c</span>

<span class="sd">            where &#39;&gt;&#39; indicates a hmm target located on the positive strand,</span>
<span class="sd">            &#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span>
<span class="sd">            to the maximum number of genes separating matched gene a and b. </span>
<span class="sd">            Multiple hmms may be employed (limited by computational capabilities).</span>
<span class="sd">            No order symbol in a hmm indicates that results should be independent</span>
<span class="sd">            of strand location.</span>
<span class="sd">        hmm_meta (Path): path to PGAP&#39;s metadata file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str,dict]: parsed synteny structure where gene symbols are replaced</span>
<span class="sd">            by HMM names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pgap</span> <span class="o">=</span> <span class="n">PGAP</span><span class="p">(</span><span class="n">hmm_meta</span><span class="p">)</span>
    <span class="n">gene_symbols</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getGeneSymbolsInStructure</span><span class="p">(</span>
        <span class="n">synteny_structure</span>
        <span class="p">)</span>
    <span class="n">strand_locs</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getStrandsInStructure</span><span class="p">(</span>
        <span class="n">synteny_structure</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="n">gene_dists</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getMaximumDistancesInStructure</span><span class="p">(</span>
        <span class="n">synteny_structure</span>
        <span class="p">)</span>
    <span class="n">hmm_groups</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">gene_symbol</span><span class="p">:</span> <span class="n">pgap</span><span class="o">.</span><span class="n">getHMMgroupForGeneSymbol</span><span class="p">(</span><span class="n">gene_symbol</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">gene_symbol</span> <span class="ow">in</span> <span class="n">gene_symbols</span>
    <span class="p">}</span>
    <span class="n">unmatched_genes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">gene_id</span> <span class="k">for</span> <span class="n">gene_id</span><span class="p">,</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="n">hmm_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hmm_group</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">unmatched_genes</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;These genes did not get a HMM match in database: </span><span class="si">{</span><span class="n">unmatched_genes</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">hmm_synteny_struc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">strand</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">hmm_group</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">strand_locs</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">gene_dists</span><span class="p">,</span> <span class="n">hmm_groups</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;|&quot;</span> <span class="ow">in</span> <span class="n">hmm_group</span><span class="p">:</span>
            <span class="n">hmm_group</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">hmm_synteny_struc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">strand</span><span class="si">}{</span><span class="n">hmm_group</span><span class="si">}</span><span class="s2"> &quot;</span>

    <span class="k">return</span> <span class="n">hmm_synteny_struc</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">hmm_groups</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.parseSyntenyStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parse synteny structure string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>synteny_structure</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a string like the following:</p>
<blockquote>
<p>hmm_a n_ab &lt;hmm_b n_bc hmm_c</p>
</blockquote>
<p>where '&gt;' indicates a hmm target located on the positive strand,
'&lt;' a target located on the negative strand, and n_ab cooresponds 
to the maximum number of genes separating matched gene a and b. 
Multiple hmms may be employed (limited by computational capabilities).
No order symbol in a hmm indicates that results should be independent
of strand location.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>parsed synteny structure.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parseSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Parse synteny structure string.</span>

<span class="sd">    Args:</span>
<span class="sd">        synteny_structure (str): a string like the following:</span>
<span class="sd">            &gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c</span>

<span class="sd">            where &#39;&gt;&#39; indicates a hmm target located on the positive strand,</span>
<span class="sd">            &#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span>
<span class="sd">            to the maximum number of genes separating matched gene a and b. </span>
<span class="sd">            Multiple hmms may be employed (limited by computational capabilities).</span>
<span class="sd">            No order symbol in a hmm indicates that results should be independent</span>
<span class="sd">            of strand location.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: parsed synteny structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_dists</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getMaximumDistancesInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="n">hmm_groups</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getHMMgroupsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="n">strands</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getStrandsInStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hmm_groups&quot;</span><span class="p">:</span> <span class="n">hmm_groups</span><span class="p">,</span> <span class="s2">&quot;strands&quot;</span><span class="p">:</span> <span class="n">strands</span><span class="p">,</span> <span class="s2">&quot;distances&quot;</span><span class="p">:</span> <span class="n">max_dists</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.reformatSyntenyStructure" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reformatSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove illegal symbols and extra white space.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">reformatSyntenyStructure</span><span class="p">(</span><span class="n">synteny_structure</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Remove illegal symbols and extra white space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">synteny_structure</span> <span class="o">=</span> <span class="n">synteny_structure</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">&quot; |&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;| &quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">synteny_structure</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.parser.SyntenyParser.splitStrandFromLocus" class="doc doc-heading">
<code class="highlight language-python"><span class="n">splitStrandFromLocus</span><span class="p">(</span><span class="n">locus_str</span><span class="p">,</span> <span class="n">parsed_symbol</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Split strand info from locus tag / HMM model.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>locus_str</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a substring of a synteny structure containing 
a gene symbol / HMM name and strand info.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>parsed_symbol</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>if True, strand info '&gt;' is parsed 
as 'pos' and '&lt;' as 'neg'. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[str]</code>
          </td>
          <td><p>tuple[str]: tuple with parsed strand info and gene symbol / HMM name.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/parser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">splitStrandFromLocus</span><span class="p">(</span><span class="n">locus_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">parsed_symbol</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Split strand info from locus tag / HMM model.</span>

<span class="sd">    Args:</span>
<span class="sd">        locus_str (str): a substring of a synteny structure containing </span>
<span class="sd">            a gene symbol / HMM name and strand info.</span>
<span class="sd">        parsed_symbol (bool, optional): if True, strand info &#39;&gt;&#39; is parsed </span>
<span class="sd">            as &#39;pos&#39; and &#39;&lt;&#39; as &#39;neg&#39;. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[str]: tuple with parsed strand info and gene symbol / HMM name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">locus_str</span> <span class="o">=</span> <span class="n">locus_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">or</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="n">sense</span> <span class="o">=</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">locus_str</span> <span class="o">=</span> <span class="n">locus_str</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">parsed_symbol</span><span class="p">:</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span> <span class="k">if</span> <span class="n">sense</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="k">else</span> <span class="s1">&#39;neg&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">strand</span> <span class="o">=</span> <span class="n">sense</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">strand</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">strand</span><span class="p">,</span> <span class="n">locus_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="module-cli">Module cli</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.cli"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.cli.Pynteny" class="doc doc-heading">
        <code>Pynteny</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Main command based on:
https://selvakumar-arumugapandian.medium.com/  \
command-line-subcommands-with-pythons-argparse-4dbac80f7110</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/cli.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Pynteny</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Main command based on:</span>
<span class="sd">    https://selvakumar-arumugapandian.medium.com/  \\</span>
<span class="sd">    command-line-subcommands-with-pythons-argparse-4dbac80f7110</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subcommand_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Initialize main command</span>

<span class="sd">        Args:</span>
<span class="sd">            subcommand (str): subcommand name</span>
<span class="sd">            subcommand_args (list[str]): list of subcommand arguments and values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subcommand</span> <span class="o">=</span> <span class="n">subcommand</span>
        <span class="k">if</span> <span class="s2">&quot;--hmmsearch_args&quot;</span> <span class="ow">in</span> <span class="n">subcommand_args</span><span class="p">:</span>
            <span class="n">hmm_arg_idx</span> <span class="o">=</span> <span class="n">subcommand_args</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;--hmmsearch_args&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">subcommand_args</span><span class="p">[</span><span class="n">hmm_arg_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">subcommand_args</span><span class="p">[</span><span class="n">hmm_arg_idx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span> <span class="o">=</span> <span class="n">subcommand_args</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_printLogo</span><span class="p">()),</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny &lt;subcommand&gt; [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generateCoolQuotes</span><span class="p">()),</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_positionals</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;subcommands&quot;</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;search </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;build </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;parse </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;download </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;app </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;cite </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">),</span>
            <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;subcommand&quot;</span><span class="p">,</span>
            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span><span class="s2">&quot;--version&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;show version and exit&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand</span><span class="p">)</span>
        <span class="n">input_subcommand</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="s2">&quot;subcommand&quot;</span><span class="p">)</span>
        <span class="n">ConfigParser</span><span class="o">.</span><span class="n">initialize_config_file</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_subcommand</span><span class="p">(</span><span class="n">subcommand_name</span><span class="o">=</span><span class="n">input_subcommand</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_printLogo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ____              __                  </span>
<span class="sd">   / __ \__  ______  / /____  ____  __  __</span>
<span class="sd">  / /_/ / / / / __ \/ __/ _ \/ __ \/ / / /</span>
<span class="sd"> / ____/ /_/ / / / / /_/  __/ / / / /_/ / </span>
<span class="sd">/_/    \__, /_/ /_/\__/\___/_/ /_/\__, /  </span>
<span class="sd">      /____/                     /____/   </span>

<span class="sd">&quot;&quot;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Synteny-based Hmmer searches made easy, v</span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;SemidÃ¡n Robaina EstÃ©vez (srobaina@ull.edu.es), 2022</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generateCoolQuotes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">quotes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;May the force be with you (Yoda)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;This looks like a job for a computer (AI)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;This is such a wonderful day to do bioinformatics (SR)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;One does not simply walk into Mordor (J.R.R. Tolkien)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Damn, looks like a rainy day, let&#39;s do bioiformatics! (SR)&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">quotes</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot; &quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_call_subcommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcommand_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="n">subcommand</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcommand_name</span><span class="p">)</span>
        <span class="n">subcommand</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call search subcommand.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">synteny_search</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call build subcommand.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">build_database</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call parse subcommand.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call download subcommand.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">download_hmms</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run pynteny app through Streamlit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">app</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">run_app</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print pynteny&#39;s citation string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">cite</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
        <span class="n">args</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
        <span class="n">sub</span><span class="o">.</span><span class="n">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">subcommand</span><span class="p">,</span> <span class="n">subcommand_args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize main command</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subcommand</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>subcommand name</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>subcommand_args</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td><p>list of subcommand arguments and values.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subcommand_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Initialize main command</span>

<span class="sd">    Args:</span>
<span class="sd">        subcommand (str): subcommand name</span>
<span class="sd">        subcommand_args (list[str]): list of subcommand arguments and values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_subcommand</span> <span class="o">=</span> <span class="n">subcommand</span>
    <span class="k">if</span> <span class="s2">&quot;--hmmsearch_args&quot;</span> <span class="ow">in</span> <span class="n">subcommand_args</span><span class="p">:</span>
        <span class="n">hmm_arg_idx</span> <span class="o">=</span> <span class="n">subcommand_args</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;--hmmsearch_args&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">subcommand_args</span><span class="p">[</span><span class="n">hmm_arg_idx</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">subcommand_args</span><span class="p">[</span><span class="n">hmm_arg_idx</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span> <span class="o">=</span> <span class="n">subcommand_args</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_printLogo</span><span class="p">()),</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny &lt;subcommand&gt; [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generateCoolQuotes</span><span class="p">()),</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_positionals</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;subcommands&quot;</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;search </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;build </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;parse </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;download </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;app </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;cite </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">),</span>
        <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;subcommand&quot;</span><span class="p">,</span>
        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-v&quot;</span><span class="p">,</span><span class="s2">&quot;--version&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;show version and exit&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand</span><span class="p">)</span>
    <span class="n">input_subcommand</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="s2">&quot;subcommand&quot;</span><span class="p">)</span>
    <span class="n">ConfigParser</span><span class="o">.</span><span class="n">initialize_config_file</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_call_subcommand</span><span class="p">(</span><span class="n">subcommand_name</span><span class="o">=</span><span class="n">input_subcommand</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.app" class="doc doc-heading">
<code class="highlight language-python"><span class="n">app</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run pynteny app through Streamlit</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run pynteny app through Streamlit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">app</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">run_app</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Call build subcommand.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call build subcommand.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">build_database</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.cite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cite</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Print pynteny's citation string</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print pynteny&#39;s citation string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">cite</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">args</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.download" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Call download subcommand.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call download subcommand.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">download_hmms</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Call parse subcommand.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call parse subcommand.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.Pynteny.search" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Call search subcommand.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Call search subcommand.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">SubcommandParser</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subcommand_args</span><span class="p">)</span>
    <span class="n">sub</span><span class="o">.</span><span class="n">synteny_search</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.cli.SubcommandParser" class="doc doc-heading">
        <code>SubcommandParser</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Argparse parsers for Pynteny's subcommands</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/cli.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SubcommandParser</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Argparse parsers for Pynteny&#39;s subcommands</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">getHelpStr</span><span class="p">(</span><span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get help string for subcommand.</span>

<span class="sd">        Args:</span>
<span class="sd">            subcommand (str): subcommand name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: help string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">SubcommandParser</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">)()</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">help_file</span><span class="p">:</span>
                <span class="n">help_str</span> <span class="o">=</span> <span class="n">help_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">help_str</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the search subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Query sequence database for HMM hits arranged in provided synteny structure.&quot;</span>
                <span class="p">),</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny search [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>

        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

        <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--synteny_struc&quot;</span><span class="p">,</span> 
                            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;synteny_struc&quot;</span><span class="p">,</span> 
                            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;string displaying hmm structure to search for, such as: </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;&#39;&gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;where &#39;&gt;&#39; indicates a hmm target located on the positive strand, </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;&#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;to the maximum number of genes separating matched genes a and b. </span><span class="se">\n</span><span class="s2">&quot;</span> 
                                <span class="sa">f</span><span class="s2">&quot;Multiple hmms may be employed. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;No order symbol in a hmm indicates that results should be independent </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot;of strand location. &quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="s2">&quot;--data&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to peptide database&quot;</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_dir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_dir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;path to directory containing hmm (i.e, tigrfam or pfam) models. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;The directory can contain more hmm models than used in the synteny structure. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;It may also be the path to a compressed (tar, tar.gz, tgz) directory. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;If not provided, hmm models (PGAP database) will be downloaded from the NCBI.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;(if not already downloaded)&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outdir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outdir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to output directory&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-x&quot;</span><span class="p">,</span> <span class="s2">&quot;--prefix&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;prefix to be added to output files&quot;</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="s2">&quot;--processes&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;maximum number of processes available to HMMER. Defaults to all but one.&quot;</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmmsearch_args&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmmsearch_args&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;list of comma-separated additional arguments to hmmsearch for each input hmm. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;A single argument may be provided, in which case the same additional argument </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;is employed in all hmms.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="s2">&quot;--gene_ids&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;gene_ids&quot;</span><span class="p">,</span>
                             <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;use gene symbols in synteny structure instead of HMM names. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;If set, a path to the hmm database metadata file must be provided </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;in argument &#39;--hmm_meta&#39;&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-u&quot;</span><span class="p">,</span> <span class="s2">&quot;--unordered&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unordered&quot;</span><span class="p">,</span>
                             <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;whether the HMMs should be arranged in the exact same order displayed </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;in the synteny_structure or in  any order. If ordered, the filters will </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;filter collinear rather than syntenic structures. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;If more than two HMMs are employed, the largest maximum distance among any </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;pair is considered to run the search.&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;--reuse&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;reuse&quot;</span><span class="p">,</span>
                             <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;reuse hmmsearch result table in following synteny searches. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Do not delete hmmer_outputs subdirectory for this option to work.&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_meta&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_meta&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to hmm database metadata file&quot;</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the build subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Translate nucleotide assembly file and assign contig and gene location info </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;to each identified ORF (using prodigal). Label predicted ORFs according to </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;positional info and export a fasta file containing predicted and translated ORFs. </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Alternatively, extract peptide sequences from GenBank file containing ORF annotations </span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;and write labelled peptide sequences to a fasta file.&quot;</span>
                <span class="p">),</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny build [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>

        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

        <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="s2">&quot;--data&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;path to assembly input nucleotide data or annotated GenBank file. </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;It can be a single file or a directory of files (either of FASTA or GeneBank format).&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outfile&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;path to output (labelled peptide database) file. Defaults to </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;file in directory of input data.&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--processes&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;set maximum number of processes. &quot;</span>
                                <span class="s2">&quot;Defaults to all but one.&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the parse subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Translate synteny structure with gene symbols into one with</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;HMM groups, according to provided HMM database.&quot;</span>
                <span class="p">),</span>        
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny parse [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>

        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

        <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--synteny_struc&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;synteny_struc&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                            <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;synteny structure containing gene symbols instead of HMMs&quot;</span>
                                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_meta&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_meta&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;path to hmm database metadata file. If already donwloaded with </span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;pynteny downloaded, hmm meta file is retrieved from default location.&quot;</span>
                                <span class="p">)</span>
                                <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">download</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the download subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Download HMM database from NCBI.&quot;</span>
                <span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny download [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>

        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outdir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outdir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                                <span class="s2">&quot;path to directory where to download HMM database.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Defaults to pynteny installation directory.&quot;</span>
                                <span class="p">)</span>
                             <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-u&quot;</span><span class="p">,</span> <span class="s2">&quot;--unpack&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unpack&quot;</span><span class="p">,</span>
                            <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;unpack originally compressed database files&quot;</span>
                            <span class="p">)</span>
        <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                             <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">app</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the app subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Run Pynteny in web browser.&quot;</span>
                <span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny app [-h] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>
        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cite</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Parser for the cite subcommand.</span>

<span class="sd">        Returns:</span>
<span class="sd">            argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Print pynteny&#39;s citation string.&quot;</span>
                <span class="p">),</span>
            <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny cite [-h] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
            <span class="p">)</span>
        <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.app" class="doc doc-heading">
<code class="highlight language-python"><span class="n">app</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the app subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">app</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the app subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Run Pynteny in web browser.&quot;</span>
            <span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny app [-h] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>
    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the build subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">build</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the build subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Translate nucleotide assembly file and assign contig and gene location info </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;to each identified ORF (using prodigal). Label predicted ORFs according to </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;positional info and export a fasta file containing predicted and translated ORFs. </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Alternatively, extract peptide sequences from GenBank file containing ORF annotations </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;and write labelled peptide sequences to a fasta file.&quot;</span>
            <span class="p">),</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny build [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>

    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

    <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="s2">&quot;--data&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;path to assembly input nucleotide data or annotated GenBank file. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;It can be a single file or a directory of files (either of FASTA or GeneBank format).&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outfile&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;path to output (labelled peptide database) file. Defaults to </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;file in directory of input data.&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--processes&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;set maximum number of processes. &quot;</span>
                            <span class="s2">&quot;Defaults to all but one.&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.cite" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cite</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the cite subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">cite</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the cite subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Print pynteny&#39;s citation string.&quot;</span>
            <span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny cite [-h] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>
    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.download" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the download subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">download</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the download subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Download HMM database from NCBI.&quot;</span>
            <span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny download [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>

    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outdir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outdir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;path to directory where to download HMM database.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Defaults to pynteny installation directory.&quot;</span>
                            <span class="p">)</span>
                         <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-u&quot;</span><span class="p">,</span> <span class="s2">&quot;--unpack&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unpack&quot;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;unpack originally compressed database files&quot;</span>
                        <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.getHelpStr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">getHelpStr</span><span class="p">(</span><span class="n">subcommand</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get help string for subcommand.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>subcommand</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>subcommand name.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>help string.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">getHelpStr</span><span class="p">(</span><span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get help string for subcommand.</span>

<span class="sd">    Args:</span>
<span class="sd">        subcommand (str): subcommand name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: help string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">SubcommandParser</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">)()</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">help_file</span><span class="p">:</span>
            <span class="n">help_str</span> <span class="o">=</span> <span class="n">help_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">help_str</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the parse subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the parse subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Translate synteny structure with gene symbols into one with</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;HMM groups, according to provided HMM database.&quot;</span>
            <span class="p">),</span>        
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny parse [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>

    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

    <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--synteny_struc&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;synteny_struc&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;synteny structure containing gene symbols instead of HMMs&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_meta&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_meta&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;path to hmm database metadata file. If already donwloaded with </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;pynteny downloaded, hmm meta file is retrieved from default location.&quot;</span>
                            <span class="p">)</span>
                            <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.cli.SubcommandParser.search" class="doc doc-heading">
<code class="highlight language-python"><span class="n">search</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Parser for the search subcommand.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>argparse.ArgumentParser: ArgumentParser object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/cli.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">search</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parser for the search subcommand.</span>

<span class="sd">    Returns:</span>
<span class="sd">        argparse.ArgumentParser: ArgumentParser object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Query sequence database for HMM hits arranged in provided synteny structure.&quot;</span>
            <span class="p">),</span>
        <span class="n">usage</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;pynteny search [-h] [args] </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;  </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span>
        <span class="p">)</span>

    <span class="n">optional</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s2">&quot;required arguments&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optional</span><span class="p">)</span>

    <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;--synteny_struc&quot;</span><span class="p">,</span> 
                        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;synteny_struc&quot;</span><span class="p">,</span> 
                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;string displaying hmm structure to search for, such as: </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;&#39;&gt;hmm_a n_ab &lt;hmm_b n_bc hmm_c&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;where &#39;&gt;&#39; indicates a hmm target located on the positive strand, </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;&#39;&lt;&#39; a target located on the negative strand, and n_ab cooresponds </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;to the maximum number of genes separating matched genes a and b. </span><span class="se">\n</span><span class="s2">&quot;</span> 
                            <span class="sa">f</span><span class="s2">&quot;Multiple hmms may be employed. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;No order symbol in a hmm indicates that results should be independent </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;of strand location. &quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="s2">&quot;--data&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to peptide database&quot;</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_dir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_dir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;path to directory containing hmm (i.e, tigrfam or pfam) models. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;The directory can contain more hmm models than used in the synteny structure. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;It may also be the path to a compressed (tar, tar.gz, tgz) directory. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;If not provided, hmm models (PGAP database) will be downloaded from the NCBI.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;(if not already downloaded)&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="s2">&quot;--outdir&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;outdir&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to output directory&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-x&quot;</span><span class="p">,</span> <span class="s2">&quot;--prefix&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;prefix to be added to output files&quot;</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="s2">&quot;--processes&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;maximum number of processes available to HMMER. Defaults to all but one.&quot;</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmmsearch_args&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmmsearch_args&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;list of comma-separated additional arguments to hmmsearch for each input hmm. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;A single argument may be provided, in which case the same additional argument </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;is employed in all hmms.&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="s2">&quot;--gene_ids&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;gene_ids&quot;</span><span class="p">,</span>
                         <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;use gene symbols in synteny structure instead of HMM names. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;If set, a path to the hmm database metadata file must be provided </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;in argument &#39;--hmm_meta&#39;&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-u&quot;</span><span class="p">,</span> <span class="s2">&quot;--unordered&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unordered&quot;</span><span class="p">,</span>
                         <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;whether the HMMs should be arranged in the exact same order displayed </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;in the synteny_structure or in  any order. If ordered, the filters will </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;filter collinear rather than syntenic structures. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;If more than two HMMs are employed, the largest maximum distance among any </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;pair is considered to run the search.&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;--reuse&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;reuse&quot;</span><span class="p">,</span>
                         <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="p">(</span>
                            <span class="s2">&quot;reuse hmmsearch result table in following synteny searches. </span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Do not delete hmmer_outputs subdirectory for this option to work.&quot;</span>
                            <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;--hmm_meta&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;hmm_meta&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to hmm database metadata file&quot;</span>
    <span class="p">)</span>
    <span class="n">optional</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--log&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                         <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;path to log file. Log not written by default.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="module-subcommands">Module subcommands</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.subcommands"></a>
  <div class="doc doc-contents first">
  
      <p>Functions containing CLI subcommands</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.build_database" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_database</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Build annotated peptide database from input assembly
or GenBank data.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>arguments object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_database</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Build annotated peptide database from input assembly</span>
<span class="sd">    or GenBank data.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.ArgumentParser): arguments object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> | </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="p">),</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                            <span class="p">],</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">processes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building annotated peptide database&quot;</span><span class="p">)</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">database</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">outfile</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Database built successfully!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.download_hmms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_hmms</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Download HMM (PGAP) database from NCBI.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>arguments object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_hmms</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Download HMM (PGAP) database from NCBI.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.ArgumentParser): arguments object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> | </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="p">),</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                            <span class="p">],</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">module_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;data_downloaded&quot;</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PGAP database already downloaded. Skipping download&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">outdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">download_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">module_dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">download_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">download_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;database_dir&quot;</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;upack_PGAP_database&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">unpack</span><span class="p">)</span>

    <span class="n">data_url</span> <span class="o">=</span> <span class="s2">&quot;https://ftp.ncbi.nlm.nih.gov/hmm/current/hmm_PGAP.HMM.tgz&quot;</span>
    <span class="n">meta_url</span> <span class="o">=</span> <span class="s2">&quot;https://ftp.ncbi.nlm.nih.gov/hmm/current/hmm_PGAP.tsv&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Downloading PGAP database&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">PGAP_file</span> <span class="o">=</span> <span class="n">download_dir</span> <span class="o">/</span> <span class="s2">&quot;hmm_PGAP.HMM.tgz&quot;</span>
        <span class="n">meta_file</span> <span class="o">=</span> <span class="n">download_dir</span> <span class="o">/</span> <span class="s2">&quot;hmm_PGAP.tsv&quot;</span>
        <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">PGAP_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">meta_url</span><span class="p">,</span> <span class="n">meta_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Database dowloaded successfully</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;data_downloaded&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;PGAP_database&quot;</span><span class="p">,</span> <span class="n">PGAP_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;PGAP_meta_file&quot;</span><span class="p">,</span>  <span class="n">meta_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to download PGAP database. Please check your internet connection.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Removing missing entries from PGAP metadata file&quot;</span><span class="p">)</span>
    <span class="n">PGAP</span><span class="p">(</span><span class="n">meta_file</span><span class="p">)</span><span class="o">.</span><span class="n">removeMissingHMMsFromMetadata</span><span class="p">(</span>
        <span class="n">PGAP_file</span><span class="p">,</span>
        <span class="n">meta_file</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">unpack</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unpacking PGAP database&quot;</span><span class="p">)</span>
        <span class="n">unpacked_PGAP_dir</span> <span class="o">=</span> <span class="n">download_dir</span> <span class="o">/</span> <span class="s2">&quot;hmm_PGAP&quot;</span>
        <span class="n">PGAP</span><span class="o">.</span><span class="n">extractPGAPtoDirectory</span><span class="p">(</span>
            <span class="n">PGAP_file</span><span class="p">,</span>
            <span class="n">output_dir</span><span class="o">=</span><span class="n">unpacked_PGAP_dir</span>
        <span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PGAP_file</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;PGAP_database&quot;</span><span class="p">,</span> <span class="n">unpacked_PGAP_dir</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PGAP database unpacked successfully&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.get_citation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Get Pynteny citation string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>arguments object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>silent</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>do not print to terminal.
Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>Pyntey citation text.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_citation</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get Pynteny citation string.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.ArgumentParser): arguments object.</span>
<span class="sd">        silent (bool, optional): do not print to terminal.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Pyntey citation text.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;SemidÃ¡n Robaina EstÃ©vez (2022). Pynteny: synteny-aware hmm searches made easy&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;(Version </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">). Zenodo. https://doi.org/10.5281/zenodo.7048685&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;If you use this software, please cite it as below: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">citation</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.parse_gene_ids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Convert gene symbols to hmm names.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>arguments object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>synteny structure where gene symbols are replaced
by HMM names.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_gene_ids</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert gene symbols to hmm names.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.ArgumentParser): arguments object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: synteny structure where gene symbols are replaced</span>
<span class="sd">            by HMM names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> | </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="p">),</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                            <span class="p">],</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;data_downloaded&quot;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Please download hmm database meta file or provide path to existing one first.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;PGAP_meta_file&quot;</span><span class="p">))</span>
    <span class="n">gene_synteny_struc</span><span class="p">,</span> <span class="n">gene_to_hmm_group</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseGenesInSyntenyStructure</span><span class="p">(</span>
        <span class="n">synteny_structure</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">,</span>
        <span class="n">hmm_meta</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span>
        <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Translated </span><span class="se">\n</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="si">}</span><span class="s1">&quot; </span><span class="se">\n</span><span class="s1"> to </span><span class="se">\n</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">gene_synteny_struc</span><span class="si">}</span><span class="s1">&quot; </span><span class="se">\n</span><span class="s1"> according to provided HMM database metadata&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gene_synteny_struc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.run_app" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_app</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Run Pynteny app through streamlit</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_app</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run Pynteny app through streamlit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_config_path</span><span class="p">()</span>
    <span class="n">logfile</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">config_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;streamlit.log&quot;</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="s2">&quot;streamlit_log&quot;</span><span class="p">,</span> <span class="n">logfile</span><span class="p">)</span>
    <span class="n">app_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;app&quot;</span> <span class="o">/</span> <span class="s2">&quot;main_page.py&quot;</span>
    <span class="n">log_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;--logger.level=info 2&gt; </span><span class="si">{</span><span class="n">logfile</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cmd_str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;streamlit run </span><span class="si">{</span><span class="n">app_path</span><span class="si">}</span><span class="s2"> --browser.gatherUsageStats False --server.fileWatcherType none &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">log_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.subcommands.synteny_search" class="doc doc-heading">
<code class="highlight language-python"><span class="n">synteny_search</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Search peptide database by synteny structure containing HMMs.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>args</code></td>
          <td>
                <code>argparse.<span title="argparse.ArgumentParser">ArgumentParser</span></code>
          </td>
          <td><p>arguments object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SyntenyHits</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pynteny.filter.SyntenyHits" href="#pynteny.filter.SyntenyHits">SyntenyHits</a></code>
          </td>
          <td><p>instance of SyntenyHits.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/subcommands.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">synteny_search</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SyntenyHits</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Search peptide database by synteny structure containing HMMs.</span>

<span class="sd">    Args:</span>
<span class="sd">        args (argparse.ArgumentParser): arguments object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SyntenyHits: instance of SyntenyHits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Sequence data file does not exist&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> | </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">logfile</span><span class="p">),</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                            <span class="p">],</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
    <span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">reformatSyntenyStructure</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">isValidStructure</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid synteny structure format: </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="s2">&quot;Execute pynteny search --help to see the right format.&quot;</span>
                <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;data_downloaded&quot;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;HMM database not found. Downloading PGAP database from NCBI&quot;</span><span class="p">)</span>
            <span class="n">down_args</span> <span class="o">=</span> <span class="n">CommandArgs</span><span class="p">(</span><span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">download_hmms</span><span class="p">(</span><span class="n">down_args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;PGAP_database&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">gene_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;data_downloaded&quot;</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Please download hmm database first or provide path to hmm metadata file.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_field</span><span class="p">(</span><span class="s2">&quot;PGAP_meta_file&quot;</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Finding matching HMMs for gene symbols&quot;</span><span class="p">)</span>
        <span class="n">gene_synteny_struc</span><span class="p">,</span> <span class="n">gene_to_hmm_group</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">parseGenesInSyntenyStructure</span><span class="p">(</span>
            <span class="n">synteny_structure</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">,</span>
            <span class="n">hmm_meta</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span>
        <span class="p">)</span>
        <span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span> <span class="o">=</span> <span class="n">gene_synteny_struc</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found the following HMMs in database for given structure:</span><span class="se">\n</span><span class="si">{</span><span class="n">gene_synteny_struc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">temp_hmm_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;temp_hmm_dir&quot;</span>
    <span class="k">if</span> <span class="n">isTarFile</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span><span class="p">):</span>
        <span class="n">PGAP</span><span class="o">.</span><span class="n">extractPGAPtoDirectory</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span><span class="p">,</span> <span class="n">temp_hmm_dir</span><span class="p">)</span>
        <span class="n">hmm_dir</span> <span class="o">=</span> <span class="n">temp_hmm_dir</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hmm_dir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">hmm_dir</span>

    <span class="n">hmm_names</span> <span class="o">=</span> <span class="n">SyntenyParser</span><span class="o">.</span><span class="n">getAllHMMsInStructure</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">)</span>
    <span class="n">input_hmms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">hmm_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">hmm_name</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span> <span class="k">for</span> <span class="n">hmm_name</span> <span class="ow">in</span> <span class="n">hmm_names</span><span class="p">])</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_hmms</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">hmm_names</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Not all HMMs in synteny structure found in HMM directory. &quot;</span>
            <span class="s2">&quot;Remember to include &#39;--gene_ids&#39; option if you want to search by gene symbols.&quot;</span>
            <span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">outdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">outdir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">hmmsearch_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hmmsearch_args</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;None&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">input_hmms</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hmmsearch_args</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">hmmsearch_args</span>
    <span class="n">hmmsearch_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">hmmsearch_args</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>
    <span class="n">hmmsearch_args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="n">x</span><span class="p">,</span> <span class="n">hmmsearch_args</span><span class="p">))</span>
    <span class="n">hmmer_output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="s1">&#39;hmmer_outputs/&#39;</span><span class="p">)</span>
    <span class="n">synteny_table</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">outdir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">synteny_matched.tsv&quot;</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Searching database by synteny structure&#39;</span><span class="p">)</span>
    <span class="n">synteny_hits</span> <span class="o">=</span> <span class="n">filterFASTAbySyntenyStructure</span><span class="p">(</span>
        <span class="n">synteny_structure</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">synteny_struc</span><span class="p">,</span>
        <span class="n">unordered</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">unordered</span><span class="p">,</span>
        <span class="n">input_fasta</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">input_hmms</span><span class="o">=</span><span class="n">input_hmms</span><span class="p">,</span>
        <span class="n">hmm_meta</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">hmm_meta</span><span class="p">,</span>
        <span class="n">hmmer_output_dir</span><span class="o">=</span><span class="n">hmmer_output_dir</span><span class="p">,</span>
        <span class="n">reuse_hmmer_results</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">reuse</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hmmsearch&#39;</span><span class="p">,</span>
        <span class="n">processes</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">processes</span><span class="p">,</span>
        <span class="n">additional_args</span><span class="o">=</span><span class="n">hmmsearch_args</span>
    <span class="p">)</span>
    <span class="n">synteny_hits</span><span class="o">.</span><span class="n">writeToTSV</span><span class="p">(</span><span class="n">synteny_table</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Writing matching sequences to FASTA files&quot;</span><span class="p">)</span>
    <span class="n">synteny_hits</span><span class="o">.</span><span class="n">writeHitSequencesToFASTAfiles</span><span class="p">(</span>
        <span class="n">sequence_database</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
        <span class="n">output_prefix</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">prefix</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">temp_hmm_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_hmm_dir</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finished!&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">synteny_hits</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-utils">Module utils</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.utils"></a>
  <div class="doc doc-contents first">
  
      <p>Functions and classes for general purposes</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pynteny.utils.CommandArgs" class="doc doc-heading">
        <code>CommandArgs</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Base class to hold command line arguments.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/utils.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CommandArgs</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Base class to hold command line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pynteny.utils.ConfigParser" class="doc doc-heading">
        <code>ConfigParser</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Handle Pynteny configuration file.</p>


        <details class="quote">
          <summary>Source code in <code>pynteny/utils.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ConfigParser</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Handle Pynteny configuration file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize ConfigParser with default config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">initialize_config_file</span><span class="p">())</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">initialize_config_file</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize empty config file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: path to generated config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config.json&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;database_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;upack_PGAP_database&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;data_downloaded&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;PGAP_database&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PGAP_meta_file&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;streamlit_process&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
            <span class="p">}</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">config_file</span>

    <span class="k">def</span> <span class="nf">get_config_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Show config file path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span>

    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load config file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: dict containing fields and values of config file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">config</span>

    <span class="k">def</span> <span class="nf">write_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write config dict to file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update config file</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): config file key name to be updated.</span>
<span class="sd">            value (str): new value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_config</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get field from config file.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): key name to get the value from.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: key value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.get_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_config</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load config file.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>dict containing fields and values of config file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load config file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: dict containing fields and values of config file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.get_config_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_config_path</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Show config file path.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Show config file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.get_default_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_default_config</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize ConfigParser with default config file.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize ConfigParser with default config file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">initialize_config_file</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.get_field" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_field</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get field from config file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>key name to get the value from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td><p>key value.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get field from config file.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): key name to get the value from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: key value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.initialize_config_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">initialize_config_file</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize empty config file.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Path</code></td>          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to generated config file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">initialize_config_file</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize empty config file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: path to generated config file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config.json&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;database_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;upack_PGAP_database&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;data_downloaded&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;PGAP_database&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PGAP_meta_file&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;streamlit_process&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">config_file</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.update_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_config</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Update config file</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>config file key name to be updated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>value</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>new value.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Update config file</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): config file key name to be updated.</span>
<span class="sd">        value (str): new value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_config</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pynteny.utils.ConfigParser.write_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_config</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write config dict to file.</p>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Write config dict to file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.extractTarFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extractTarFile</span><span class="p">(</span><span class="n">tar_file</span><span class="p">,</span> <span class="n">dest_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extract tar or tar.gz files to dest_dir.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tar_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to tar file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dest_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to destination directory 
to store the uncompressed file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extractTarFile</span><span class="p">(</span><span class="n">tar_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">dest_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Extract tar or tar.gz files to dest_dir.</span>

<span class="sd">    Args:</span>
<span class="sd">        tar_file (Path): path to tar file.</span>
<span class="sd">        dest_dir (Path, optional): path to destination directory </span>
<span class="sd">            to store the uncompressed file. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dest_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dest_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">tar_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar.gz&#39;</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tar_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tgz&#39;</span><span class="p">)):</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tar_file</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">dest_dir</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">tar_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar&#39;</span><span class="p">):</span>
        <span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tar_file</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">dest_dir</span><span class="p">)</span>
        <span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Input is not a tar file&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.flattenDirectory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flattenDirectory</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Flatten directory, i.e. remove all subdirectories and
copy all files to the top level directory.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to directory.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flattenDirectory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Flatten directory, i.e. remove all subdirectories and</span>
<span class="sd">    copy all files to the top level directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory (Path): path to directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">file_parts</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

                <span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">directory</span><span class="p">,</span>
                    <span class="n">file_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">file_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dirpath</span> <span class="o">!=</span> <span class="n">directory</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.isRightListNestedType" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isRightListNestedType</span><span class="p">(</span><span class="n">list_object</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check if all elements in list are of the same type.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list_object</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list containing elements.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>inner_type</code></td>
          <td>
                <code>type</code>
          </td>
          <td><p>type to be checked.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td><p>whether list contains elements of the same specified type.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isRightListNestedType</span><span class="p">(</span><span class="n">list_object</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check if all elements in list are of the same type.</span>

<span class="sd">    Args:</span>
<span class="sd">        list_object (list): list containing elements.</span>
<span class="sd">        inner_type (type): type to be checked.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: whether list contains elements of the same specified type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">list_object</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.isTarFile" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isTarFile</span><span class="p">(</span><span class="n">tar_file</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Check whether file is tar-compressed.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tar_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td><p>whether file is compressed or not.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isTarFile</span><span class="p">(</span><span class="n">tar_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Check whether file is tar-compressed.</span>

<span class="sd">    Args:</span>
<span class="sd">        tar_file (Path): path to file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: whether file is compressed or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tar_file_str</span> <span class="o">=</span> <span class="n">tar_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">tar_file_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar.gz&#39;</span><span class="p">))</span> <span class="ow">or</span> 
        <span class="p">(</span><span class="n">tar_file_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tgz&#39;</span><span class="p">))</span> <span class="ow">or</span>
        <span class="p">(</span><span class="n">tar_file_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;tar&#39;</span><span class="p">))</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.listTarDir" class="doc doc-heading">
<code class="highlight language-python"><span class="n">listTarDir</span><span class="p">(</span><span class="n">tar_dir</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>List files within tar or tar.gz directory.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tar_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to directory containing tar files.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td><p>list of tar files.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">listTarDir</span><span class="p">(</span><span class="n">tar_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;List files within tar or tar.gz directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        tar_dir (Path): path to directory containing tar files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of tar files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tar_dir</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar_obj</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">tar_obj</span><span class="o">.</span><span class="n">getnames</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.parallelizeOverInputFiles" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parallelizeOverInputFiles</span><span class="p">(</span><span class="n">callable</span><span class="p">,</span> <span class="n">input_list</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">callable_kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Parallelize callable over a set of input objects using a pool 
of workers. Inputs in input list are passed to the first argument
of the callable. Additional callable named arguments may be passed.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callable</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td><p>function to be run.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_list</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>list of inputs to callable.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads.
Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parallelizeOverInputFiles</span><span class="p">(</span><span class="n">callable</span><span class="p">,</span>
                              <span class="n">input_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                              <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">callable_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
    <span class="sd">&quot;&quot;&quot;Parallelize callable over a set of input objects using a pool </span>
<span class="sd">    of workers. Inputs in input list are passed to the first argument</span>
<span class="sd">    of the callable. Additional callable named arguments may be passed.</span>

<span class="sd">    Args:</span>
<span class="sd">        callable (_type_): function to be run.</span>
<span class="sd">        input_list (list): list of inputs to callable.</span>
<span class="sd">        n_processes (int, optional): maximum number of threads.</span>
<span class="sd">            Defaults to all minus one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n_processes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_processes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">callable</span><span class="p">,</span> <span class="o">**</span><span class="n">callable_kwargs</span><span class="p">),</span> <span class="n">input_list</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.setDefaultOutputPath" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setDefaultOutputPath</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">only_filename</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_basename</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">only_dirname</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Utility function to generate a default path to output file
or directory based on an input file name and path.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_path</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input file.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tag</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>text tag to be added to file name. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>extension</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>change input file extension with this one. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>only_filename</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>output only default filename. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>only_basename</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>output only default basename (no extension). Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>only_dirname</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>output only path to default output directory. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Path</code></td>          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>a path or name to a default output file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">setDefaultOutputPath</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">only_filename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">only_basename</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">only_dirname</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Utility function to generate a default path to output file</span>
<span class="sd">    or directory based on an input file name and path.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_path (Path): path to input file.</span>
<span class="sd">        tag (str, optional): text tag to be added to file name. Defaults to None.</span>
<span class="sd">        extension (str, optional): change input file extension with this one. Defaults to None.</span>
<span class="sd">        only_filename (bool, optional): output only default filename. Defaults to False.</span>
<span class="sd">        only_basename (bool, optional): output only default basename (no extension). Defaults to False.</span>
<span class="sd">        only_dirname (bool, optional): output only path to default output directory. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: a path or name to a default output file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dirname</span> <span class="o">=</span> <span class="n">input_path</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">fname</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">input_path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">input_path</span><span class="o">.</span><span class="n">suffix</span>
    <span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="n">ext</span>
    <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">default_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fname</span><span class="si">}{</span><span class="n">tag</span><span class="si">}{</span><span class="n">extension</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">only_basename</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">only_filename</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">default_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">only_dirname</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">default_file</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.utils.terminalExecute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">terminalExecute</span><span class="p">(</span><span class="n">command_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">work_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Execute given command in terminal through Python.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>command_str</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>terminal command to be executed.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>suppress_shell_output</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>suppress shell output. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>work_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>change working directory. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_output</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to return execution output. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>subprocess.<span title="subprocess.STDOUT">STDOUT</span></code>
          </td>
          <td><p>subprocess.STDOUT: subprocess output.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">terminalExecute</span><span class="p">(</span><span class="n">command_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">return_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute given command in terminal through Python.</span>

<span class="sd">    Args:</span>
<span class="sd">        command_str (str): terminal command to be executed.</span>
<span class="sd">        suppress_shell_output (bool, optional): suppress shell output. Defaults to False.</span>
<span class="sd">        work_dir (Path, optional): change working directory. Defaults to None.</span>
<span class="sd">        return_output (bool, optional): whether to return execution output. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        subprocess.STDOUT: subprocess output.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">suppress_shell_output</span><span class="p">:</span>
        <span class="n">suppress_code</span> <span class="o">=</span> <span class="s2">&quot;&gt;/dev/null 2&gt;&amp;1&quot;</span>
        <span class="n">command_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">command_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">suppress_code</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">command_str</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">cwd</span><span class="o">=</span><span class="n">work_dir</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="n">return_output</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="module-wrappers">Module wrappers</h2>


<div class="doc doc-object doc-module">


<a id="pynteny.wrappers"></a>
  <div class="doc doc-contents first">
  
      <p>Simple CLI wrappers to several tools</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="pynteny.wrappers.runHMMsearch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">runHMMsearch</span><span class="p">(</span><span class="n">hmm_model</span><span class="p">,</span> <span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hmmsearch&#39;</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Simple CLI wrapper to hmmsearch or hmmscan.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hmm_model</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to profile HMM to be used.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_fasta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to fasta containing sequence database to be searched.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to prodigal output table file. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>either 'hmmsearch' or 'hmmscan'. Defaults to 'hmmsearch'.</p></td>
          <td>
                <code>&#39;hmmsearch&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>n_processes</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>maximum number of threads. Defaults to all minus one.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>additional_args</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a string containing additional arguments to 
hmmsearch/scan. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/wrappers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">runHMMsearch</span><span class="p">(</span><span class="n">hmm_model</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">input_fasta</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                 <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hmmsearch&#39;</span><span class="p">,</span>
                 <span class="n">n_processes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">additional_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Simple CLI wrapper to hmmsearch or hmmscan.</span>

<span class="sd">    Args:</span>
<span class="sd">        hmm_model (Path): path to profile HMM to be used.</span>
<span class="sd">        input_fasta (Path): path to fasta containing sequence database to be searched.</span>
<span class="sd">        output_file (Path, optional): path to prodigal output table file. Defaults to None.</span>
<span class="sd">        method (str, optional): either &#39;hmmsearch&#39; or &#39;hmmscan&#39;. Defaults to &#39;hmmsearch&#39;.</span>
<span class="sd">        n_processes (int, optional): maximum number of threads. Defaults to all minus one.</span>
<span class="sd">        additional_args (str, optional): a string containing additional arguments to </span>
<span class="sd">            hmmsearch/scan. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n_processes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_processes</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">setDefaultOutputPath</span><span class="p">(</span><span class="n">input_fasta</span><span class="p">,</span> <span class="s1">&#39;_hmmer_hits&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">additional_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args_str</span> <span class="o">=</span> <span class="n">additional_args</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">cmd_str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1"> --tblout </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">args_str</span><span class="si">}</span><span class="s1"> --cpu </span><span class="si">{</span><span class="n">n_processes</span><span class="si">}</span><span class="s1"> &#39;</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hmm_model</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">input_fasta</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
    <span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.wrappers.runProdigal" class="doc doc-heading">
<code class="highlight language-python"><span class="n">runProdigal</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;fasta&#39;</span><span class="p">,</span> <span class="n">metagenome</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">additional_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Simple CLI wrapper to prodigal.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input fasta file with nucleotide sequences.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_file</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output file containing translated peptides.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output directory (all prodigal output files).
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>either 'gbk' or 'fasta'. Defaults to 'fasta'.</p></td>
          <td>
                <code>&#39;fasta&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>metagenome</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether input fasta correspond to a metagenomic sample.
Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>additional_args</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>a string containing additional arguments to prodigal.
Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/wrappers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">runProdigal</span><span class="p">(</span><span class="n">input_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
                <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">output_dir</span> <span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fasta&quot;</span><span class="p">,</span>
                <span class="n">metagenome</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">additional_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple CLI wrapper to prodigal.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file (Path): path to input fasta file with nucleotide sequences.</span>
<span class="sd">        output_file (Path, optional): path to output file containing translated peptides.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        output_dir (Path, optional): path to output directory (all prodigal output files).</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        output_format (str, optional): either &#39;gbk&#39; or &#39;fasta&#39;. Defaults to &#39;fasta&#39;.</span>
<span class="sd">        metagenome (bool, optional): whether input fasta correspond to a metagenomic sample.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        additional_args (str, optional): a string containing additional arguments to prodigal.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">metagenome</span><span class="p">:</span>
        <span class="n">procedure</span> <span class="o">=</span> <span class="s2">&quot;meta&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">procedure</span> <span class="o">=</span> <span class="s2">&quot;single&quot;</span>
    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;fasta&quot;</span> <span class="ow">in</span> <span class="n">output_format</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">prodigal_output.faa&quot;</span>
        <span class="n">out_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-a </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">input_file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">prodigal_output.gbk&quot;</span>
        <span class="n">out_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-o </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">additional_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args_str</span> <span class="o">=</span> <span class="n">additional_args</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">cmd_str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;prodigal -i </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2"> -p </span><span class="si">{</span><span class="n">procedure</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;-q </span><span class="si">{</span><span class="n">out_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">args_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pynteny.wrappers.runSeqKitNoDup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">runSeqKitNoDup</span><span class="p">(</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_fasta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">export_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Simpe CLI wrapper to seqkit rmdup to remove sequence duplicates
in fasta file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_fasta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to input fasta.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_fasta</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>path to output fasta. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>export_duplicates</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to export a file containing 
duplicated sequences. Defaults to False.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pynteny/wrappers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">runSeqKitNoDup</span><span class="p">(</span><span class="n">input_fasta</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_fasta</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                   <span class="n">export_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simpe CLI wrapper to seqkit rmdup to remove sequence duplicates</span>
<span class="sd">    in fasta file.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_fasta (Path): path to input fasta.</span>
<span class="sd">        output_fasta (Path, optional): path to output fasta. Defaults to None.</span>
<span class="sd">        export_duplicates (bool, optional): whether to export a file containing </span>
<span class="sd">            duplicated sequences. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_fasta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_fasta</span> <span class="o">=</span> <span class="n">setDefaultOutputPath</span><span class="p">(</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;_no_duplicates&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">export_duplicates</span><span class="p">:</span>
        <span class="n">dup_file</span> <span class="o">=</span> <span class="n">setDefaultOutputPath</span><span class="p">(</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;_duplicates&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
        <span class="n">dup_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;-D </span><span class="si">{</span><span class="n">dup_file</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dup_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">cmd_str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;seqkit rmdup </span><span class="si">{</span><span class="n">input_fasta</span><span class="si">}</span><span class="s2"> -s </span><span class="si">{</span><span class="n">dup_str</span><span class="si">}</span><span class="s2"> -o </span><span class="si">{</span><span class="n">output_fasta</span><span class="o">.</span><span class="n">as_posix</span><span class="p">()</span><span class="si">}</span><span class="s2"> --quiet&quot;</span>
    <span class="p">)</span>
    <span class="n">terminalExecute</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">,</span> <span class="n">suppress_shell_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../examples/example_sus/" class="btn btn-neutral float-left" title="Sus operon"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Robaina/Pynteny" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../examples/example_sus/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../javascripts/mathjax.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
